var IgxDatePickerComponent_1;
import { __decorate, __param } from "tslib";
import { CommonModule, formatDate } from '@angular/common';
import { Component, ContentChild, EventEmitter, HostBinding, Input, NgModule, OnDestroy, Output, ViewChild, ElementRef, TemplateRef, Inject, ChangeDetectorRef, HostListener, NgModuleRef, OnInit, AfterViewInit, Injector, AfterViewChecked } from '@angular/core';
import { NG_VALUE_ACCESSOR, NgControl } from '@angular/forms';
import { IgxCalendarHeaderTemplateDirective, IgxCalendarModule, IgxCalendarSubheaderTemplateDirective, WEEKDAYS, isDateInRanges } from '../calendar/index';
import { IgxIconModule } from '../icon/index';
import { IgxInputGroupModule, IgxInputDirective, IgxInputGroupComponent, IgxInputState } from '../input-group/index';
import { Subject, fromEvent, animationFrameScheduler, interval } from 'rxjs';
import { filter, takeUntil, throttle } from 'rxjs/operators';
import { IgxTextSelectionModule } from '../directives/text-selection/text-selection.directive';
import { OverlaySettings, IgxOverlayService, PositionSettings, AbsoluteScrollStrategy, AutoPositionStrategy, OverlayCancelableEventArgs } from '../services/index';
import { IgxButtonModule } from '../directives/button/button.directive';
import { IgxRippleModule } from '../directives/ripple/ripple.directive';
import { IgxMaskModule } from '../directives/mask/mask.directive';
import { DatePickerUtil } from './date-picker.utils';
import { DatePickerDisplayValuePipe, DatePickerInputValuePipe } from './date-picker.pipes';
import { isIE, isEqual } from '../core/utils';
import { IgxDatePickerTemplateDirective, IgxDatePickerActionsDirective } from './date-picker.directives';
import { IgxCalendarContainerComponent } from './calendar-container.component';
import { InteractionMode } from '../core/enums';
import { fadeIn, fadeOut } from '../animations/fade';
import { DeprecateProperty } from '../core/deprecateDecorators';
let NEXT_ID = 0;
/**
 * This enumeration is used to configure the date picker to operate with pre-defined format option used in Angular DatePipe.
 * 'https://angular.io/api/common/DatePipe'
 * 'shortDate': equivalent to 'M/d/yy' (6/15/15).
 * 'mediumDate': equivalent to 'MMM d, y' (Jun 15, 2015).
 * 'longDate': equivalent to 'MMMM d, y' (June 15, 2015).
 * 'fullDate': equivalent to 'EEEE, MMMM d, y' (Monday, June 15, 2015).
 */
export var PredefinedFormatOptions;
(function (PredefinedFormatOptions) {
    PredefinedFormatOptions["ShortDate"] = "shortDate";
    PredefinedFormatOptions["MediumDate"] = "mediumDate";
    PredefinedFormatOptions["LongDate"] = "longDate";
    PredefinedFormatOptions["FullDate"] = "fullDate";
})(PredefinedFormatOptions || (PredefinedFormatOptions = {}));
const noop = () => { };
const ɵ0 = noop;
/**
 * Date Picker displays a popup calendar that lets users select a single date.
 *@igxModule IgxDatePickerModule
 *@igxTheme igx-calendar-theme, igx-icon-theme
 *@igxGroup Scheduling
 *@igxKeywords  datepicker, calendar, schedule, date
 *@example
 * ```html
 * <igx-date-picker [(ngModel)]="selectedDate"></igx-date-picker>
 * ```
 */
let IgxDatePickerComponent = IgxDatePickerComponent_1 = class IgxDatePickerComponent {
    constructor(_overlayService, element, _cdr, _moduleRef, _injector) {
        this._overlayService = _overlayService;
        this.element = element;
        this._cdr = _cdr;
        this._moduleRef = _moduleRef;
        this._injector = _injector;
        /**
         * Gets/Sets the `IgxDatePickerComponent` label.
         * @remarks
         * The default label is 'Date'.
         * @example
         * ```html
         * <igx-date-picker [label]="Calendar"></igx-date-picker>
         * ```
         */
        this.label = 'Date';
        /**
         * Gets/Sets the `IgxDatePickerComponent` label visibility.
         * @remarks
         * By default the visibility is set to true.
         * @example
         * <igx-date-picker [labelVisibility]="false"></igx-date-picker>
         */
        this.labelVisibility = true;
        /**
         *Gets/Sets on which day the week starts.
         @example
         *```html
         *<igx-date-picker [weekStart]="WEEKDAYS.FRIDAY" cancelButtonLabel="cancel" todayButtonLabel="today"></igx-date-picker>
         *```
         */
        this.weekStart = WEEKDAYS.SUNDAY;
        /**
         * Gets/Sets the number of month views displayed.
         * @remarks
         * Default value is `1`.
         * @example
         * ```html
         * <igx-date-picker [monthsViewNumber]="2"></igx-date-picker>
         * ```
         * @example
         * ```typescript
         * let monthViewsDisplayed = this.datePicker.monthsViewNumber;
         * ```
         */
        this.monthsViewNumber = 1;
        /**
         *Gets/Sets the value of `id` attribute.
         *@remarks If not provided it will be automatically generated.
         *@example
         *```html
         *<igx-date-picker [id]="'igx-date-picker-3'" cancelButtonLabel="cancel" todayButtonLabel="today"></igx-date-picker>
         *```
         */
        this.id = `igx-date-picker-${NEXT_ID++}`;
        /**
         *Gets/Sets the orientation of the `IgxDatePickerComponent` header.
         *@example
         *```html
         *<igx-date-picker [vertical]="'true'" cancelButtonLabel="cancel" todayButtonLabel="today"></igx-date-picker>
         *```
         */
        this.vertical = false;
        /**
         *Gets/Sets the interaction mode - dialog or drop down.
         *@example
         *```html
         *<igx-date-picker mode="dropdown"></igx-date-picker>
         *```
         */
        this.mode = InteractionMode.Dialog;
        /**
         *Gets/Sets whether date should spin continuously or stop when min/max is reached.
         *@example
         *```html
         *<igx-date-picker [isSpinLoop]="false"></igx-date-picker>
         *```
         */
        this.isSpinLoop = true;
        /**
         *Emitted when the `IgxDatePickerComponent` calendar is opened.
        */
        this.onOpened = new EventEmitter();
        /**
         *Emitted after the `IgxDatePickerComponent` is closed.
        */
        this.onClosed = new EventEmitter();
        /**
         *Emitted when the `IgxDatePickerComponent` is being closed.
         */
        this.onClosing = new EventEmitter();
        /**
         *Emitted when selection is made in the calendar.
         *@example
         *```html
         *<igx-date-picker (onSelection)="selection($event)"></igx-date-picker>
         *```
         */
        this.onSelection = new EventEmitter();
        /**
         *Emitted when date picker value is changed.
         *@example
        *```html
        *<igx-date-picker (valueChange)="valueChanged($event)" mode="dropdown"></igx-date-picker>
        *```
        */
        this.valueChange = new EventEmitter();
        /**
        *Emitted when the user types/spins to a disabled date in the date-picker editor.
        *@example
        *```html
        *<igx-date-picker (onDisabledDate)="onDisabledDate($event)"></igx-date-picker>
        *```
        */
        this.onDisabledDate = new EventEmitter();
        /**
        *Emitted when the user types/spins invalid date in the date-picker editor.
        *@example
        *```html
        *<igx-date-picker (onValidationFailed)="onValidationFailed($event)"></igx-date-picker>
        *```
        */
        this.onValidationFailed = new EventEmitter();
        /**@hidden @internal*/
        this.hasHeader = true;
        /**@hidden @internal*/
        this.collapsed = true;
        /**@hidden @internal*/
        this.displayValuePipe = new DatePickerDisplayValuePipe(this);
        /**@hidden @internal*/
        this.inputValuePipe = new DatePickerInputValuePipe(this);
        /**@hidden @internal*/
        this.dateFormatParts = [];
        /**@hidden @internal*/
        this.isEmpty = true;
        /**@hidden @internal*/
        this.invalidDate = '';
        this.spinDelta = 1;
        this.defaultLocale = 'en';
        this._formatOptions = {
            day: 'numeric',
            month: 'short',
            weekday: 'short',
            year: 'numeric'
        };
        this._formatViews = {
            day: false,
            month: true,
            year: false
        };
        this._destroy$ = new Subject();
        this._disabledDates = null;
        this._specialDates = null;
        this._onOpen = new EventEmitter();
        this._onClose = new EventEmitter();
        this._ngControl = null;
        //#region ControlValueAccessor
        this._onChangeCallback = noop;
        this._onTouchedCallback = noop;
    }
    /**
     *Gets the format options of the `IgxDatePickerComponent`.
     @example
     *```typescript
        let formatOptions = this.datePicker.formatOptions;
     *```
     */
    get formatOptions() {
        return this._formatOptions;
    }
    /**
     *Sets the format options of the `IgxDatePickerComponent`.
     *@example
     *```typescript
     * this.datePicker.formatOptions = {  day: "numeric",  month: "long", weekday: "long", year: "numeric"};
     *```
     */
    set formatOptions(formatOptions) {
        this._formatOptions = Object.assign(this._formatOptions, formatOptions);
    }
    /**
     *Gets/Sets the date display format of the `IgxDatePickerComponent` in dropdown mode.
     @example
     *```typescript
     * let format = this.datePicker.format;
     * this.datePicker.format = 'yyyy-M-d';
     *```
     */
    get format() {
        return (this._format === undefined) ? PredefinedFormatOptions.ShortDate : this._format;
    }
    set format(format) {
        this._format = format;
    }
    /**
     *Gets/Sets the format views of the `IgxDatePickerComponent`.
     *@example
     *```typescript
     * let formatViews = this.datePicker.formatViews;
     *  this.datePicker.formatViews = {day:false, month: false, year:false};
     *```
     */
    get formatViews() {
        return this._formatViews;
    }
    set formatViews(formatViews) {
        this._formatViews = Object.assign(this._formatViews, formatViews);
    }
    /**
     * Gets/Sets the disabled dates descriptors.
     * @example
     * ```typescript
     * let disabledDates = this.datepicker.disabledDates;
     * this.datePicker.disabledDates = [ {type: DateRangeType.Weekends}, ...];
     * ```
     */
    get disabledDates() {
        return this._disabledDates;
    }
    set disabledDates(value) {
        this._disabledDates = value;
    }
    /**
     * Gets/Sets the special dates descriptors.
     * @example
     * ```typescript
     * let specialDates = this.datepicker.specialDates;
     * this.datePicker.specialDates = [ {type: DateRangeType.Weekends}, ... ];
     * ```
     */
    get specialDates() {
        return this._specialDates;
    }
    set specialDates(value) {
        this._specialDates = value;
    }
    /**
    * Gets/Sets the modal overlay settings.
    */
    get modalOverlaySettings() {
        return this._modalOverlay;
    }
    set modalOverlaySettings(value) {
        this._modalOverlay = value;
    }
    /**
    * Gets/Sets the drop-down overlay settings.
    */
    get dropDownOverlaySettings() {
        return this._dropDownOverlaySettings || this._defaultDropDownOverlaySettings;
    }
    set dropDownOverlaySettings(value) {
        this._dropDownOverlaySettings = value;
    }
    /**
     *Gets the formatted date when `IgxDatePickerComponent` is in dialog mode.
     *@example
     *```typescript
     *let selectedDate = this.datePicker.displayData;
     *```
     */
    get displayData() {
        if (this.value) {
            return this._customFormatChecker(this.formatter, this.value);
        }
        return '';
    }
    /**
     @hidden @internal
     */
    get transformedDate() {
        if (this._value) {
            this._transformedDate = (this._isInEditMode) ? this._getEditorDate(this._value) : this._getDisplayDate(this._value);
            this.isEmpty = false;
        }
        else {
            this._transformedDate = (this._isInEditMode) ? DatePickerUtil.maskToPromptChars(this.inputMask) : '';
        }
        return this._transformedDate;
    }
    /**
     @hidden @internal
     */
    set transformedDate(value) {
        this._transformedDate = value;
    }
    /**
     * Gets the input group template.
     * @example
     * ```typescript
     * let template = this.template();
     * ```
     */
    get template() {
        if (this.datePickerTemplateDirective) {
            return this.datePickerTemplateDirective.template;
        }
        return (this.mode === InteractionMode.Dialog) ? this.readOnlyDatePickerTemplate : this.editableDatePickerTemplate;
    }
    /**
     * Gets the context passed to the input group template.
     */
    get context() {
        return {
            disabled: this.disabled,
            disabledDates: this.disabledDates,
            displayData: this.displayData,
            format: this.format,
            isSpinLoop: this.isSpinLoop,
            label: this.label,
            labelVisibility: this.labelVisibility,
            locale: this.locale,
            mask: this.mask,
            mode: this.mode,
            specialDates: this.specialDates,
            value: this.value,
            openDialog: (target) => this.openDialog(target)
        };
    }
    get required() {
        if (this._ngControl && this._ngControl.control && this._ngControl.control.validator) {
            // Run the validation with empty object to check if required is enabled.
            const error = this._ngControl.control.validator({});
            return error && error.required;
        }
        return false;
    }
    /**
     *Gets/Sets the selected date.
     *@example
     *```html
     *<igx-date-picker [value]="date"></igx-date-picker>
     *```
     */
    get value() {
        return this._value;
    }
    set value(date) {
        this._value = date;
        this._onChangeCallback(date);
    }
    /**
     * @deprecated Use 'onOpened' instead.
     *An event that is emitted when the `IgxDatePickerComponent` calendar is opened.
     *@example
     *```typescript
     *public open(event){
     *    alert("The date-picker calendar has been opened!");
     *}
     *```
     *```html
     *<igx-date-picker (onOpen)="open($event)" cancelButtonLabel="cancel" todayButtonLabel="today"></igx-date-picker>
     *```
     */
    get onOpen() {
        return this._onOpen;
    }
    set onOpen(val) {
        this._onOpen = val;
    }
    /**
     * @deprecated Use 'onClosed' instead.
     *"An event that is emitted when the `IgxDatePickerComponent` is closed.
     *@example
     *```typescript
     *public close(event){
     *    alert("The date-picker has been closed!");
     *}
     *```
     *```html
     *<igx-date-picker (onClose)="close($event)" cancelButtonLabel="cancel" todayButtonLabel="today"></igx-date-picker>
     *```
     */
    get onClose() {
        return this._onClose;
    }
    set onClose(val) {
        this._onClose = val;
    }
    /** @hidden @internal */
    writeValue(value) {
        this._value = value;
        // TODO: do we need next call
        this._cdr.markForCheck();
    }
    /** @hidden @internal */
    registerOnChange(fn) { this._onChangeCallback = fn; }
    /** @hidden @internal */
    registerOnTouched(fn) { this._onTouchedCallback = fn; }
    /** @hidden @internal */
    setDisabledState(isDisabled) { this.disabled = isDisabled; }
    //#endregion
    /**
    * @hidden
    */
    onSpaceClick(event) {
        this.openDialog(this.getInputGroupElement());
        event.preventDefault();
    }
    /** @hidden */
    getEditElement() {
        const inputDirectiveElementRef = this._inputElementRef || this._inputUserTemplateElementRef;
        return (inputDirectiveElementRef) ? inputDirectiveElementRef.nativeElement : null;
    }
    /**
     *@hidden @internal
     */
    getInputGroupElement() {
        return this.inputGroup ? this.inputGroup.element.nativeElement : null;
    }
    /**
     *@hidden @internal
     */
    ngOnInit() {
        this._positionSettings = {
            openAnimation: fadeIn,
            closeAnimation: fadeOut
        };
        this._defaultDropDownOverlaySettings = {
            closeOnOutsideClick: true,
            modal: false,
            scrollStrategy: new AbsoluteScrollStrategy(),
            positionStrategy: new AutoPositionStrategy(this._positionSettings),
            outlet: this.outlet
        };
        this._modalOverlaySettings = {
            closeOnOutsideClick: true,
            modal: true,
            outlet: this.outlet
        };
        this._overlayService.onOpening.pipe(filter((overlay) => overlay.id === this._componentID), takeUntil(this._destroy$)).subscribe((eventArgs) => {
            this._onOpening(eventArgs);
        });
        this._overlayService.onOpened.pipe(filter((overlay) => overlay.id === this._componentID), takeUntil(this._destroy$)).subscribe(() => {
            this._onOpened();
        });
        this._overlayService.onClosed.pipe(filter(overlay => overlay.id === this._componentID), takeUntil(this._destroy$)).subscribe(() => {
            this._onClosed();
        });
        this._overlayService.onClosing.pipe(filter(overlay => overlay.id === this._componentID), takeUntil(this._destroy$)).subscribe((event) => {
            this.onClosing.emit(event);
            // If canceled in a user onClosing handler
            if (event.cancel) {
                return;
            }
            // Do not focus the input if clicking outside in dropdown mode
            const input = this.getEditElement();
            if (input && !(event.event && this.mode === InteractionMode.DropDown)) {
                input.focus();
            }
            else {
                // outside click
                this._updateValidityOnBlur();
            }
        });
        if (this.mode === InteractionMode.DropDown) {
            this.dateFormatParts = DatePickerUtil.parseDateFormat(this.mask, this.locale);
            if (this.mask === undefined) {
                this.mask = DatePickerUtil.getMask(this.dateFormatParts);
            }
            this.inputMask = DatePickerUtil.getInputMask(this.dateFormatParts);
        }
        this._ngControl = this._injector.get(NgControl, null);
    }
    /**
     *@hidden @internal
    */
    ngAfterViewInit() {
        if (this.mode === InteractionMode.DropDown && this._inputElementRef) {
            fromEvent(this._inputElementRef.nativeElement, 'keydown').pipe(throttle(() => interval(0, animationFrameScheduler)), takeUntil(this._destroy$)).subscribe((res) => this.onKeyDown(res));
        }
        if (this._ngControl) {
            this._statusChanges$ = this._ngControl.statusChanges.subscribe(this.onStatusChanged.bind(this));
        }
    }
    ngAfterViewChecked() {
        // if one sets mode at run time this forces initialization of new igxInputGroup
        // As a result a new igxInputDirective is initialized too. In ngAfterViewInit of
        // the new directive isRequired of the igxInputGroup is set again. However
        // ngAfterViewInit of date picker is not called again and we may finish with wrong
        // isRequired in igxInputGroup. This is why we should set it her, only when needed
        if (this.inputGroup && this.inputGroup.isRequired !== this.required) {
            this.inputGroup.isRequired = this.required;
            this._cdr.detectChanges();
        }
    }
    onStatusChanged() {
        if ((this._ngControl.control.touched || this._ngControl.control.dirty) &&
            (this._ngControl.control.validator || this._ngControl.control.asyncValidator)) {
            if (this.inputGroup.isFocused) {
                this._inputDirective.valid = this._ngControl.valid ? IgxInputState.VALID : IgxInputState.INVALID;
            }
            else {
                this._inputDirective.valid = this._ngControl.valid ? IgxInputState.INITIAL : IgxInputState.INVALID;
            }
        }
        if (this.inputGroup && this.inputGroup.isRequired !== this.required) {
            this.inputGroup.isRequired = this.required;
        }
    }
    /**
     *@hidden @internal
    */
    ngOnDestroy() {
        if (this._componentID) {
            this._overlayService.hide(this._componentID);
        }
        this._destroy$.next(true);
        this._destroy$.complete();
    }
    /**
     *Selects today's date from calendar.
     *@remarks
     *Changes the input field value, @calendar.viewDate and @calendar.value.
     *@example
     *```typescript
     *this.datePicker.triggerTodaySelection();
     *```
     */
    triggerTodaySelection() {
        const today = new Date(Date.now());
        this.handleSelection(today);
    }
    /**
     * Change the calendar selection.
     * @remarks
     * Calling this method will emit the @calendar.onSelection event,
     * which will fire @handleSelection method.
     * @example
     *```typescript
     *this.datePicker.selectDate(this.date);
     * ```
     * @param date passed date that has to be set to the calendar.
     */
    selectDate(date) {
        const oldValue = this.value;
        this.value = date;
        this.emitValueChangeEvent(oldValue, this.value);
        this.onSelection.emit(date);
    }
    /**
     * Deselects the calendar date.
     * @example
     *```typescript
     *this.datePicker.deselectDate();
     * ```
     */
    deselectDate() {
        const oldValue = this.value;
        this.value = null;
        this.emitValueChangeEvent(oldValue, this.value);
        if (this.calendar) {
            this.calendar.deselectDate();
        }
    }
    /**
     * Opens the date picker drop down or dialog.
     * @param target HTMLElement - the target element to use for positioning the drop down container according to
     * @example
     * ```typescript
     * this.datePicker.openDialog(target);
     * ```
     */
    openDialog(target) {
        if (!this.collapsed) {
            return;
        }
        switch (this.mode) {
            case InteractionMode.Dialog: {
                this.hasHeader = true;
                const modalOverlay = (this.modalOverlaySettings !== undefined) ? this._modalOverlay : this._modalOverlaySettings;
                this._componentID = this._overlayService.attach(IgxCalendarContainerComponent, modalOverlay, this._moduleRef);
                this._overlayService.show(this._componentID);
                break;
            }
            case InteractionMode.DropDown: {
                this.hasHeader = false;
                if (target) {
                    this.dropDownOverlaySettings.positionStrategy.settings.target = target;
                }
                this._componentID = this._overlayService.attach(IgxCalendarContainerComponent, this.dropDownOverlaySettings, this._moduleRef);
                this._overlayService.show(this._componentID);
                break;
            }
        }
    }
    mouseDown(e) {
        // if the click is not on the input but in input group
        // e.g. on prefix or sufix, prevent default and this way prevent blur
        if (e.target !== this.getEditElement()) {
            e.preventDefault();
        }
    }
    /**
     * Close the calendar.
     *
     * @hidden @internal
     */
    closeCalendar() {
        this._overlayService.hide(this._componentID);
    }
    /**
     * Clear the input field, date picker value and calendar selection.
     *
     * @hidden @internal
     */
    clear() {
        this.isEmpty = true;
        this.invalidDate = '';
        this.deselectDate();
        this._setCursorPosition(0);
    }
    /**
     * Evaluates when @calendar.onSelection event was fired
     * and update the input value.
     *
     * @param event selected value from calendar.
     *
     * @hidden @internal
     */
    handleSelection(date) {
        if (this.value) {
            date.setHours(this.value.getHours());
            date.setMinutes(this.value.getMinutes());
            date.setSeconds(this.value.getSeconds());
            date.setMilliseconds(this.value.getMilliseconds());
        }
        const oldValue = this.value;
        this.value = date;
        this.emitValueChangeEvent(oldValue, this.value);
        this.calendar.viewDate = date;
        this.closeCalendar();
        this.onSelection.emit(date);
    }
    /**
    * @hidden @internal
    */
    onBlur(event) {
        this._isInEditMode = false;
        if (this.mode === InteractionMode.DropDown) {
            this.calculateDate(event.target.value, event.type);
        }
        if (this.collapsed) {
            this._updateValidityOnBlur();
        }
    }
    /**
    * @hidden @internal
    */
    onFocus() {
        this._isInEditMode = true;
        if (this.value && this.invalidDate === '') {
            this._transformedDate = this._getEditorDate(this.value);
        }
    }
    /**
    * @hidden @internal
    */
    onKeyDown(event) {
        switch (event.key) {
            case "ArrowUp" /* UP_ARROW */:
            case "Up" /* UP_ARROW_IE */:
                event.preventDefault();
                event.stopPropagation();
                this.spinValue(event.target.value, 1, event.type);
                break;
            case "ArrowDown" /* DOWN_ARROW */:
            case "Down" /* DOWN_ARROW_IE */:
                if (event.altKey) {
                    this.openDialog(this.getInputGroupElement());
                }
                else {
                    event.preventDefault();
                    event.stopPropagation();
                    this.spinValue(event.target.value, -1, event.type);
                }
                break;
            default:
                break;
        }
    }
    /**
    * @hidden @internal
    */
    onWheel(event) {
        if (this._isInEditMode) {
            event.preventDefault();
            event.stopPropagation();
            const sign = (event.deltaY > 0) ? -1 : 1;
            this.spinValue(event.target.value, sign, event.type);
        }
    }
    /**
    * @hidden @internal
    */
    onInput(event) {
        const targetValue = event.target.value;
        const cursorPosition = this._getCursorPosition();
        const checkInput = DatePickerUtil.checkForCompleteDateInput(this.dateFormatParts, targetValue);
        this._isInEditMode = true;
        if (targetValue !== DatePickerUtil.maskToPromptChars(this.inputMask)) {
            this.isEmpty = false;
        }
        // If all date parts are completed, change the date-picker value, stay in edit mode
        if (checkInput === 'complete' && event.inputType !== 'deleteContentBackward') {
            this._transformedDate = targetValue;
            this.calculateDate(targetValue, event.type);
            this._setCursorPosition(cursorPosition);
        }
        else if (checkInput === 'partial') {
            // While editing, if one date part is deleted, date-picker value is set to null, the remaining input stays intact.
            this.deselectDate();
            requestAnimationFrame(() => {
                this.getEditElement().value = targetValue;
                this._setCursorPosition(cursorPosition);
            });
        }
        else if (checkInput === 'empty') {
            // Total clean-up as input is deleted.
            this.isEmpty = true;
            this.deselectDate();
        }
    }
    emitValueChangeEvent(oldValue, newValue) {
        if (!isEqual(oldValue, newValue)) {
            this.valueChange.emit(newValue);
        }
    }
    calculateDate(dateString, invokedByEvent) {
        if (dateString !== '') {
            const prevDateValue = this.value;
            const inputValue = (invokedByEvent === 'blur') ? this.rawDateString : dateString;
            const newDateArray = DatePickerUtil.parseDateArray(this.dateFormatParts, prevDateValue, inputValue);
            if (newDateArray.state === "valid" /* Valid */) {
                const newValue = newDateArray.date;
                // Restore the time part if any
                if (prevDateValue) {
                    newValue.setHours(prevDateValue.getHours());
                    newValue.setMinutes(prevDateValue.getMinutes());
                    newValue.setSeconds(prevDateValue.getSeconds());
                    newValue.setMilliseconds(prevDateValue.getMilliseconds());
                }
                if (this.disabledDates === null
                    || (this.disabledDates !== null && !isDateInRanges(newValue, this.disabledDates))) {
                    const oldValue = this.value;
                    this.value = newValue;
                    this.emitValueChangeEvent(oldValue, this.value);
                    this.invalidDate = '';
                }
                else {
                    const args = {
                        datePicker: this,
                        currentValue: newValue,
                    };
                    this.onDisabledDate.emit(args);
                }
            }
            else {
                const args = {
                    datePicker: this,
                    prevValue: prevDateValue
                };
                this.invalidDate = dateString;
                this.onValidationFailed.emit(args);
            }
        }
    }
    spinValue(inputValue, sign, eventType) {
        this._isInEditMode = true;
        this.isEmpty = false;
        const cursorPosition = this._getCursorPosition();
        const modifiedInputValue = DatePickerUtil.getModifiedDateInput(this.dateFormatParts, inputValue, cursorPosition, this.spinDelta * sign, this.isSpinLoop);
        this.getEditElement().value = modifiedInputValue;
        this._setCursorPosition(cursorPosition);
        const checkInput = DatePickerUtil.checkForCompleteDateInput(this.dateFormatParts, modifiedInputValue);
        if (checkInput === 'complete') {
            this._isInEditMode = true;
            this.calculateDate(modifiedInputValue, eventType);
            this._setCursorPosition(cursorPosition);
        }
    }
    _onOpening(event) {
        this._initializeCalendarContainer(event.componentRef.instance);
        this.collapsed = false;
    }
    _onOpened() {
        this.onOpened.emit(this);
        // TODO: remove this line after deprecating 'onOpen'
        this._onOpen.emit(this);
        if (this.calendar) {
            this._focusCalendarDate();
        }
    }
    _onClosed() {
        this.collapsed = true;
        this._componentID = null;
        this.onClosed.emit(this);
    }
    _initializeCalendarContainer(componentInstance) {
        this.calendar = componentInstance.calendar;
        const isVertical = (this.vertical && this.mode === InteractionMode.Dialog);
        this.calendar.hasHeader = this.hasHeader;
        this.calendar.formatOptions = this.formatOptions;
        this.calendar.formatViews = this.formatViews;
        this.calendar.locale = this.locale;
        this.calendar.vertical = isVertical;
        this.calendar.weekStart = this.weekStart;
        this.calendar.specialDates = this.specialDates;
        this.calendar.disabledDates = this.disabledDates;
        this.calendar.headerTemplate = this.headerTemplate;
        this.calendar.subheaderTemplate = this.subheaderTemplate;
        this.calendar.hideOutsideDays = this.hideOutsideDays;
        this.calendar.monthsViewNumber = this.monthsViewNumber;
        this.calendar.onSelection.pipe(takeUntil(this._destroy$)).subscribe((ev) => this.handleSelection(ev));
        if (this.value) {
            this.calendar.value = this.value;
            this.calendar.viewDate = this.value;
        }
        componentInstance.mode = this.mode;
        componentInstance.vertical = isVertical;
        componentInstance.cancelButtonLabel = this.cancelButtonLabel;
        componentInstance.todayButtonLabel = this.todayButtonLabel;
        componentInstance.datePickerActions = this.datePickerActionsDirective;
        componentInstance.onClose.pipe(takeUntil(this._destroy$)).subscribe(() => this.closeCalendar());
        componentInstance.onTodaySelection.pipe(takeUntil(this._destroy$)).subscribe(() => this.triggerTodaySelection());
    }
    // Focus a date, after the calendar appearance into DOM.
    _focusCalendarDate() {
        requestAnimationFrame(() => {
            this.calendar.daysView.focusActiveDate();
        });
    }
    _setLocaleToDate(value) {
        if (isIE()) {
            // this is a workaround fixing the following IE11 issue:
            // IE11 has added character code 8206 (mark for RTL) to the output of toLocaleDateString() that
            // precedes each portion that comprises the total date... For more information read this article:
            // tslint:disable-next-line: max-line-length
            // https://www.csgpro.com/blog/2016/08/a-bad-date-with-internet-explorer-11-trouble-with-new-unicode-characters-in-javascript-date-strings/
            const localeDateStrIE = new Date(value.getFullYear(), value.getMonth(), value.getDate(), value.getHours(), value.getMinutes(), value.getSeconds(), value.getMilliseconds());
            return localeDateStrIE.toLocaleDateString(this.locale);
        }
        return value.toLocaleDateString(this.locale);
    }
    _getCursorPosition() {
        return this.getEditElement().selectionStart;
    }
    _setCursorPosition(start, end = start) {
        requestAnimationFrame(() => {
            this.getEditElement().setSelectionRange(start, end);
        });
    }
    /**
     * Apply custom user formatter upon date.
     * @param formatter custom formatter function.
     * @param date passed date
     */
    _customFormatChecker(formatter, date) {
        return this.formatter ? this.formatter(date) : this._setLocaleToDate(date);
    }
    /*
    * Transforms the date according to the specified format when `IgxDatePickerComponent` is in edit mode
    * using @angular/common formatDate method: https://angular.io/api/common/formatDate
    * @param  value: string | number | Date
    * @returns formatted string
    */
    _getDisplayDate(value) {
        if (this.format && !this.formatter) {
            const locale = this.locale || this.defaultLocale;
            return formatDate(value, this.format, locale);
        }
        else {
            return this._customFormatChecker(this.formatter, value);
        }
    }
    _getEditorDate(value) {
        const locale = this.locale || this.defaultLocale;
        const changedValue = (value) ? formatDate(value, this.mask, locale) : '';
        return DatePickerUtil.addPromptCharsEditMode(this.dateFormatParts, this.value, changedValue);
    }
    _updateValidityOnBlur() {
        this._onTouchedCallback();
        const input = this._inputDirective || this._inputDirectiveUserTemplate;
        if (input && this._ngControl && !this._ngControl.valid) {
            input.valid = IgxInputState.INVALID;
        }
        else {
            input.valid = IgxInputState.INITIAL;
        }
    }
};
IgxDatePickerComponent.ctorParameters = () => [
    { type: IgxOverlayService, decorators: [{ type: Inject, args: [IgxOverlayService,] }] },
    { type: ElementRef },
    { type: ChangeDetectorRef },
    { type: NgModuleRef },
    { type: Injector }
];
__decorate([
    Input()
], IgxDatePickerComponent.prototype, "label", void 0);
__decorate([
    Input()
], IgxDatePickerComponent.prototype, "labelVisibility", void 0);
__decorate([
    Input()
], IgxDatePickerComponent.prototype, "locale", void 0);
__decorate([
    Input()
], IgxDatePickerComponent.prototype, "weekStart", void 0);
__decorate([
    Input()
], IgxDatePickerComponent.prototype, "formatOptions", null);
__decorate([
    Input()
], IgxDatePickerComponent.prototype, "hideOutsideDays", void 0);
__decorate([
    Input()
], IgxDatePickerComponent.prototype, "monthsViewNumber", void 0);
__decorate([
    Input()
], IgxDatePickerComponent.prototype, "format", null);
__decorate([
    Input()
], IgxDatePickerComponent.prototype, "mask", void 0);
__decorate([
    Input()
], IgxDatePickerComponent.prototype, "formatViews", null);
__decorate([
    Input()
], IgxDatePickerComponent.prototype, "disabledDates", null);
__decorate([
    Input()
], IgxDatePickerComponent.prototype, "specialDates", null);
__decorate([
    Input()
], IgxDatePickerComponent.prototype, "modalOverlaySettings", null);
__decorate([
    Input()
], IgxDatePickerComponent.prototype, "dropDownOverlaySettings", null);
__decorate([
    Input()
], IgxDatePickerComponent.prototype, "value", null);
__decorate([
    HostBinding('attr.id'),
    Input()
], IgxDatePickerComponent.prototype, "id", void 0);
__decorate([
    Input()
], IgxDatePickerComponent.prototype, "formatter", void 0);
__decorate([
    Input()
], IgxDatePickerComponent.prototype, "disabled", void 0);
__decorate([
    Input()
], IgxDatePickerComponent.prototype, "vertical", void 0);
__decorate([
    Input()
], IgxDatePickerComponent.prototype, "todayButtonLabel", void 0);
__decorate([
    Input()
], IgxDatePickerComponent.prototype, "cancelButtonLabel", void 0);
__decorate([
    Input()
], IgxDatePickerComponent.prototype, "mode", void 0);
__decorate([
    Input()
], IgxDatePickerComponent.prototype, "isSpinLoop", void 0);
__decorate([
    Input()
], IgxDatePickerComponent.prototype, "outlet", void 0);
__decorate([
    DeprecateProperty(`'onOpen' @Output property is deprecated. Use 'onOpened' instead.`),
    Output()
], IgxDatePickerComponent.prototype, "onOpen", null);
__decorate([
    Output()
], IgxDatePickerComponent.prototype, "onOpened", void 0);
__decorate([
    DeprecateProperty(`'onClose' @Output property is deprecated. Use 'onClosed' instead.`),
    Output()
], IgxDatePickerComponent.prototype, "onClose", null);
__decorate([
    Output()
], IgxDatePickerComponent.prototype, "onClosed", void 0);
__decorate([
    Output()
], IgxDatePickerComponent.prototype, "onClosing", void 0);
__decorate([
    Output()
], IgxDatePickerComponent.prototype, "onSelection", void 0);
__decorate([
    Output()
], IgxDatePickerComponent.prototype, "valueChange", void 0);
__decorate([
    Output()
], IgxDatePickerComponent.prototype, "onDisabledDate", void 0);
__decorate([
    Output()
], IgxDatePickerComponent.prototype, "onValidationFailed", void 0);
__decorate([
    ViewChild('readOnlyDatePickerTemplate', { read: TemplateRef, static: true })
], IgxDatePickerComponent.prototype, "readOnlyDatePickerTemplate", void 0);
__decorate([
    ViewChild('editableDatePickerTemplate', { read: TemplateRef, static: true })
], IgxDatePickerComponent.prototype, "editableDatePickerTemplate", void 0);
__decorate([
    ViewChild(IgxInputGroupComponent)
], IgxDatePickerComponent.prototype, "inputGroup", void 0);
__decorate([
    ViewChild(IgxInputDirective, { read: ElementRef })
], IgxDatePickerComponent.prototype, "_inputElementRef", void 0);
__decorate([
    ContentChild(IgxInputDirective, { read: ElementRef })
], IgxDatePickerComponent.prototype, "_inputUserTemplateElementRef", void 0);
__decorate([
    ViewChild(IgxInputDirective)
], IgxDatePickerComponent.prototype, "_inputDirective", void 0);
__decorate([
    ContentChild(IgxInputDirective)
], IgxDatePickerComponent.prototype, "_inputDirectiveUserTemplate", void 0);
__decorate([
    ContentChild(IgxDatePickerTemplateDirective, { read: IgxDatePickerTemplateDirective })
], IgxDatePickerComponent.prototype, "datePickerTemplateDirective", void 0);
__decorate([
    ContentChild(IgxCalendarHeaderTemplateDirective, { read: IgxCalendarHeaderTemplateDirective })
], IgxDatePickerComponent.prototype, "headerTemplate", void 0);
__decorate([
    ContentChild(IgxCalendarSubheaderTemplateDirective, { read: IgxCalendarSubheaderTemplateDirective })
], IgxDatePickerComponent.prototype, "subheaderTemplate", void 0);
__decorate([
    ContentChild(IgxDatePickerActionsDirective, { read: IgxDatePickerActionsDirective })
], IgxDatePickerComponent.prototype, "datePickerActionsDirective", void 0);
__decorate([
    HostListener('keydown.spacebar', ['$event']),
    HostListener('keydown.space', ['$event'])
], IgxDatePickerComponent.prototype, "onSpaceClick", null);
IgxDatePickerComponent = IgxDatePickerComponent_1 = __decorate([
    Component({
        providers: [{
                provide: NG_VALUE_ACCESSOR,
                useExisting: IgxDatePickerComponent_1,
                multi: true
            }],
        // tslint:disable-next-line:component-selector
        selector: 'igx-date-picker',
        template: "<ng-template #readOnlyDatePickerTemplate>\n    <igx-input-group (click)=\"openDialog()\" (mousedown)=\"mouseDown($event)\">\n        <igx-prefix>\n            <igx-icon>today</igx-icon>\n        </igx-prefix>\n        <label *ngIf=\"labelVisibility\" igxLabel>{{label}}</label>\n        <input\n            class=\"igx-date-picker__input-date\"\n            igxInput\n            [value]=\"displayData || ''\"\n            [disabled]=\"disabled\"\n            (blur)=\"onBlur($event)\"\n            readonly\n        />\n    </igx-input-group>\n</ng-template>\n\n<ng-template #editableDatePickerTemplate>\n    <igx-input-group #editableInputGroup [supressInputAutofocus]=\"true\" (mousedown)=\"mouseDown($event)\">\n        <igx-prefix (click)=\"openDialog(editableInputGroup.element.nativeElement)\">\n            <igx-icon>today</igx-icon>\n        </igx-prefix>\n        <label *ngIf=\"labelVisibility\" igxLabel>{{label}}</label>\n        <input\n            class=\"igx-date-picker__input-date\"\n            igxInput\n            [igxTextSelection]=\"true\"\n            type=\"text\"\n            [value]=\"transformedDate\"\n            [igxMask]=\"inputMask\"\n            [placeholder]=\"mask\"\n            [disabled]=\"disabled\"\n            [displayValuePipe]=\"displayValuePipe\"\n            [focusedValuePipe]=\"inputValuePipe\"\n            (blur)=\"onBlur($event)\"\n            (wheel)=\"onWheel($event)\"\n            (input)=\"onInput($event)\"\n            (focus)=\"onFocus()\"\n        />\n        <igx-suffix *ngIf=\"!isEmpty\" (click)=\"clear()\">\n            <igx-icon>clear</igx-icon>\n        </igx-suffix>\n    </igx-input-group>\n</ng-template>\n\n<ng-container *ngTemplateOutlet=\"template; context: context\"></ng-container>\n",
        styles: [`
        :host {
            display: block;
        }
    `]
    }),
    __param(0, Inject(IgxOverlayService))
], IgxDatePickerComponent);
export { IgxDatePickerComponent };
/**
 * @hidden
 */
let IgxDatePickerModule = class IgxDatePickerModule {
};
IgxDatePickerModule = __decorate([
    NgModule({
        declarations: [
            IgxDatePickerComponent,
            IgxCalendarContainerComponent,
            IgxDatePickerActionsDirective,
            IgxDatePickerTemplateDirective,
            DatePickerDisplayValuePipe,
            DatePickerInputValuePipe
        ],
        entryComponents: [
            IgxCalendarContainerComponent
        ],
        exports: [
            IgxDatePickerComponent,
            IgxDatePickerTemplateDirective,
            IgxDatePickerActionsDirective,
            DatePickerDisplayValuePipe,
            DatePickerInputValuePipe
        ],
        imports: [
            CommonModule,
            IgxIconModule,
            IgxInputGroupModule,
            IgxCalendarModule,
            IgxButtonModule,
            IgxRippleModule,
            IgxMaskModule,
            IgxTextSelectionModule
        ]
    })
], IgxDatePickerModule);
export { IgxDatePickerModule };
export { ɵ0 };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZGF0ZS1waWNrZXIuY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6Im5nOi8vaWduaXRldWktYW5ndWxhci8iLCJzb3VyY2VzIjpbImxpYi9kYXRlLXBpY2tlci9kYXRlLXBpY2tlci5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFBQSxPQUFPLEVBQUUsWUFBWSxFQUFFLFVBQVUsRUFBRSxNQUFNLGlCQUFpQixDQUFDO0FBQzNELE9BQU8sRUFDSCxTQUFTLEVBQ1QsWUFBWSxFQUNaLFlBQVksRUFDWixXQUFXLEVBQ1gsS0FBSyxFQUNMLFFBQVEsRUFDUixTQUFTLEVBQ1QsTUFBTSxFQUNOLFNBQVMsRUFDVCxVQUFVLEVBQ1YsV0FBVyxFQUNYLE1BQU0sRUFDTixpQkFBaUIsRUFDakIsWUFBWSxFQUNaLFdBQVcsRUFDWCxNQUFNLEVBQ04sYUFBYSxFQUNiLFFBQVEsRUFDUixnQkFBZ0IsRUFDbkIsTUFBTSxlQUFlLENBQUM7QUFDdkIsT0FBTyxFQUF3QixpQkFBaUIsRUFBRSxTQUFTLEVBQW1CLE1BQU0sZ0JBQWdCLENBQUM7QUFDckcsT0FBTyxFQUVILGtDQUFrQyxFQUNsQyxpQkFBaUIsRUFDakIscUNBQXFDLEVBQ3JDLFFBQVEsRUFDUixjQUFjLEVBQ2pCLE1BQU0sbUJBQW1CLENBQUM7QUFDM0IsT0FBTyxFQUFFLGFBQWEsRUFBRSxNQUFNLGVBQWUsQ0FBQztBQUM5QyxPQUFPLEVBQUUsbUJBQW1CLEVBQUUsaUJBQWlCLEVBQUUsc0JBQXNCLEVBQUUsYUFBYSxFQUFFLE1BQU0sc0JBQXNCLENBQUM7QUFDckgsT0FBTyxFQUFFLE9BQU8sRUFBRSxTQUFTLEVBQUUsdUJBQXVCLEVBQUUsUUFBUSxFQUFnQixNQUFNLE1BQU0sQ0FBQztBQUMzRixPQUFPLEVBQUUsTUFBTSxFQUFFLFNBQVMsRUFBRSxRQUFRLEVBQUUsTUFBTSxnQkFBZ0IsQ0FBQztBQUU3RCxPQUFPLEVBQUUsc0JBQXNCLEVBQUMsTUFBTSx1REFBdUQsQ0FBQztBQUM5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QUNELGVBQWUsRUFBRTtZQUNiLDZCQUE2QjtTQUNoQztRQUNELE9BQU8sRUFBRTtZQUNMLHNCQUFzQjtZQUN0Qiw4QkFBOEI7WUFDOUIsNkJBQTZCO1lBQzdCLDBCQUEwQjtZQUMxQix3QkFBd0I7U0FDM0I7UUFDRCxPQUFPLEVBQUU7WUFDTCxZQUFZO1lBQ1osYUFBYTtZQUNiLG1CQUFtQjtZQUNuQixpQkFBaUI7WUFDakIsZUFBZTtZQUNmLGVBQWU7WUFDZixhQUFhO1lBQ2Isc0JBQXNCO1NBQ3pCO0tBQ0osQ0FBQztHQUNXLG1CQUFtQixDQUFJO1NBQXZCLG1CQUFtQiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IENvbW1vbk1vZHVsZSwgZm9ybWF0RGF0ZSB9IGZyb20gJ0Bhbmd1bGFyL2NvbW1vbic7XG5pbXBvcnQge1xuICAgIENvbXBvbmVudCxcbiAgICBDb250ZW50Q2hpbGQsXG4gICAgRXZlbnRFbWl0dGVyLFxuICAgIEhvc3RCaW5kaW5nLFxuICAgIElucHV0LFxuICAgIE5nTW9kdWxlLFxuICAgIE9uRGVzdHJveSxcbiAgICBPdXRwdXQsXG4gICAgVmlld0NoaWxkLFxuICAgIEVsZW1lbnRSZWYsXG4gICAgVGVtcGxhdGVSZWYsXG4gICAgSW5qZWN0LFxuICAgIENoYW5nZURldGVjdG9yUmVmLFxuICAgIEhvc3RMaXN0ZW5lcixcbiAgICBOZ01vZHVsZVJlZixcbiAgICBPbkluaXQsXG4gICAgQWZ0ZXJWaWV3SW5pdCxcbiAgICBJbmplY3RvcixcbiAgICBBZnRlclZpZXdDaGVja2VkXG59IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IHsgQ29udHJvbFZhbHVlQWNjZXNzb3IsIE5HX1ZBTFVFX0FDQ0VTU09SLCBOZ0NvbnRyb2wsIEFic3RyYWN0Q29udHJvbCB9IGZyb20gJ0Bhbmd1bGFyL2Zvcm1zJztcbmltcG9ydCB7XG4gICAgSWd4Q2FsZW5kYXJDb21wb25lbnQsXG4gICAgSWd4Q2FsZW5kYXJIZWFkZXJUZW1wbGF0ZURpcmVjdGl2ZSxcbiAgICBJZ3hDYWxlbmRhck1vZHVsZSxcbiAgICBJZ3hDYWxlbmRhclN1YmhlYWRlclRlbXBsYXRlRGlyZWN0aXZlLFxuICAgIFdFRUtEQVlTLFxuICAgIGlzRGF0ZUluUmFuZ2VzXG59IGZyb20gJy4uL2NhbGVuZGFyL2luZGV4JztcbmltcG9ydCB7IElneEljb25Nb2R1bGUgfSBmcm9tICcuLi9pY29uL2luZGV4JztcbmltcG9ydCB7IElneElucHV0R3JvdXBNb2R1bGUsIElneElucHV0RGlyZWN0aXZlLCBJZ3hJbnB1dEdyb3VwQ29tcG9uZW50LCBJZ3hJbnB1dFN0YXRlIH0gZnJvbSAnLi4vaW5wdXQtZ3JvdXAvaW5kZXgnO1xuaW1wb3J0IHsgU3ViamVjdCwgZnJvbUV2ZW50LCBhbmltYXRpb25GcmFtZVNjaGVkdWxlciwgaW50ZXJ2YWwsIFN1YnNjcmlwdGlvbiB9IGZyb20gJ3J4anMnO1xuaW1wb3J0IHsgZmlsdGVyLCB0YWtlVW50aWwsIHRocm90dGxlIH0gZnJvbSAncnhqcy9vcGVyYXRvcnMnO1xuaW1wb3J0IHsgSWd4T3ZlcmxheU91dGxldERpcmVjdGl2ZSB9IGZyb20gJy4uL2RpcmVjdGl2ZXMvdG9nZ2xlL3RvZ2dsZS5kaXJlY3RpdmUnO1xuaW1wb3J0IHsgSWd4VGV4dFNlbGVjdGlvbk1vZHVsZX0gZnJvbSAnLi4vZGlyZWN0aXZlcy90ZXh0LXNlbGVjdGlvbi90ZXh0LXNlbGVjdGlvbi5kaXJlY3RpdmUnO1xuaW1wb3J0IHtcbiAgICBPdmVybGF5U2V0dGluZ3MsXG4gICAgSWd4T3ZlcmxheVNlcnZpY2UsXG4gICAgUG9zaXRpb25TZXR0aW5ncyxcbiAgICBBYnNvbHV0ZVNjcm9sbFN0cmF0ZWd5LFxuICAgIEF1dG9Qb3NpdGlvblN0cmF0ZWd5LFxuICAgIE92ZXJsYXlDYW5jZWxhYmxlRXZlbnRBcmdzXG59IGZyb20gJy4uL3NlcnZpY2VzL2luZGV4JztcbmltcG9ydCB7IERhdGVSYW5nZURlc2NyaXB0b3IgfSBmcm9tICcuLi9jb3JlL2RhdGVzL2RhdGVSYW5nZSc7XG5pbXBvcnQgeyBFZGl0b3JQcm92aWRlciB9IGZyb20gJy4uL2NvcmUvZWRpdC1wcm92aWRlcic7XG5pbXBvcnQgeyBJZ3hCdXR0b25Nb2R1bGUgfSBmcm9tICcuLi9kaXJlY3RpdmVzL2J1dHRvbi9idXR0b24uZGlyZWN0aXZlJztcbmltcG9ydCB7IElneFJpcHBsZU1vZHVsZSB9IGZyb20gJy4uL2RpcmVjdGl2ZXMvcmlwcGxlL3JpcHBsZS5kaXJlY3RpdmUnO1xuaW1wb3J0IHsgSWd4TWFza01vZHVsZSB9IGZyb20gJy4uL2RpcmVjdGl2ZXMvbWFzay9tYXNrLmRpcmVjdGl2ZSc7XG5pbXBvcnQge1xuICAgIERhdGVQaWNrZXJVdGlsLFxuICAgIERhdGVTdGF0ZVxufSBmcm9tICcuL2RhdGUtcGlja2VyLnV0aWxzJztcbmltcG9ydCB7IERhdGVQaWNrZXJEaXNwbGF5VmFsdWVQaXBlLCBEYXRlUGlja2VySW5wdXRWYWx1ZVBpcGUgfSBmcm9tICcuL2RhdGUtcGlja2VyLnBpcGVzJztcbmltcG9ydCB7IElEYXRlUGlja2VyIH0gZnJvbSAnLi9kYXRlLXBpY2tlci5jb21tb24nO1xuaW1wb3J0IHsgS0VZUywgQ2FuY2VsYWJsZUJyb3dzZXJFdmVudEFyZ3MsIGlzSUUsIGlzRXF1YWwsIElCYXNlRXZlbnRBcmdzIH0gZnJvbSAnLi4vY29yZS91dGlscyc7XG5pbXBvcnQgeyBJZ3hEYXRlUGlja2VyVGVtcGxhdGVEaXJlY3RpdmUsIElneERhdGVQaWNrZXJBY3Rpb25zRGlyZWN0aXZlIH0gZnJvbSAnLi9kYXRlLXBpY2tlci5kaXJlY3RpdmVzJztcbmltcG9ydCB7IElneENhbGVuZGFyQ29udGFpbmVyQ29tcG9uZW50IH0gZnJvbSAnLi9jYWxlbmRhci1jb250YWluZXIuY29tcG9uZW50JztcbmltcG9ydCB7IEludGVyYWN0aW9uTW9kZSB9IGZyb20gJy4uL2NvcmUvZW51bXMnO1xuaW1wb3J0IHsgZmFkZUluLCBmYWRlT3V0IH0gZnJvbSAnLi4vYW5pbWF0aW9ucy9mYWRlJztcbmltcG9ydCB7IERlcHJlY2F0ZVByb3BlcnR5IH0gZnJvbSAnLi4vY29yZS9kZXByZWNhdGVEZWNvcmF0b3JzJztcblxubGV0IE5FWFRfSUQgPSAwO1xuXG4vKipcbiAqIFRoaXMgaW50ZXJmYWNlIGlzIHVzZWQgdG8gcHJvdmlkZSBpbmZvcm1hdGlvbiBhYm91dCBkYXRlIHBpY2tlciByZWZlcmVuY2UgYW5kIGl0cyBjdXJyZW50IHZhbHVlXG4gKiB3aGVuIG9uRGlzYWJsZWREYXRlIGV2ZW50IGlzIGZpcmVkLlxuICovXG5leHBvcnQgaW50ZXJmYWNlIElEYXRlUGlja2VyRGlzYWJsZWREYXRlRXZlbnRBcmdzIGV4dGVuZHMgSUJhc2VFdmVudEFyZ3Mge1xuICAgIGRhdGVQaWNrZXI6IElneERhdGVQaWNrZXJDb21wb25lbnQ7XG4gICAgY3VycmVudFZhbHVlOiBEYXRlO1xufVxuXG4vKipcbiAqIFRoaXMgaW50ZXJmYWNlIGlzIHVzZWQgdG8gcHJvdmlkZSBpbmZvcm1hdGlvbiBhYm91dCBkYXRlIHBpY2tlciByZWZlcmVuY2UgYW5kIGl0cyBwcmV2aW91c2x5IHZhbGlkIHZhbHVlXG4gKiB3aGVuIG9uVmFsaWRhdGlvbkZhaWxlZCBldmVudCBpcyBmaXJlZC5cbiAqL1xuZXhwb3J0IGludGVyZmFjZSBJRGF0ZVBpY2tlclZhbGlkYXRpb25GYWlsZWRFdmVudEFyZ3MgZXh0ZW5kcyBJQmFzZUV2ZW50QXJncyB7XG4gICAgZGF0ZVBpY2tlcjogSWd4RGF0ZVBpY2tlckNvbXBvbmVudDtcbiAgICBwcmV2VmFsdWU6IERhdGU7XG59XG5cbi8qKlxuICogVGhpcyBpbnRlcmZhY2UgaXMgdXNlZCB0byBjb25maWd1cmUgY2FsZW5kYXIgZm9ybWF0IHZpZXcgb3B0aW9ucy5cbiAqL1xuZXhwb3J0IGludGVyZmFjZSBJRm9ybWF0Vmlld3Mge1xuICAgIGRheT86IGJvb2xlYW47XG4gICAgbW9udGg/OiBib29sZWFuO1xuICAgIHllYXI/OiBib29sZWFuO1xufVxuXG4vKipcbiAqIFRoaXMgaW50ZXJmYWNlIGlzIHVzZWQgdG8gY29uZmlndXJlIGNhbGVuZGFyIGZvcm1hdCBvcHRpb25zLlxuICovXG5leHBvcnQgaW50ZXJmYWNlIElGb3JtYXRPcHRpb25zIHtcbiAgICBkYXk/OiBzdHJpbmc7XG4gICAgbW9udGg/OiBzdHJpbmc7XG4gICAgd2Vla2RheT86IHN0cmluZztcbiAgICB5ZWFyPzogc3RyaW5nO1xufVxuXG4vKipcbiAqIFRoaXMgZW51bWVyYXRpb24gaXMgdXNlZCB0byBjb25maWd1cmUgdGhlIGRhdGUgcGlja2VyIHRvIG9wZXJhdGUgd2l0aCBwcmUtZGVmaW5lZCBmb3JtYXQgb3B0aW9uIHVzZWQgaW4gQW5ndWxhciBEYXRlUGlwZS5cbiAqICdodHRwczovL2FuZ3VsYXIuaW8vYXBpL2NvbW1vbi9EYXRlUGlwZSdcbiAqICdzaG9ydERhdGUnOiBlcXVpdmFsZW50IHRvICdNL2QveXknICg2LzE1LzE1KS5cbiAqICdtZWRpdW1EYXRlJzogZXF1aXZhbGVudCB0byAnTU1NIGQsIHknIChKdW4gMTUsIDIwMTUpLlxuICogJ2xvbmdEYXRlJzogZXF1aXZhbGVudCB0byAnTU1NTSBkLCB5JyAoSnVuZSAxNSwgMjAxNSkuXG4gKiAnZnVsbERhdGUnOiBlcXVpdmFsZW50IHRvICdFRUVFLCBNTU1NIGQsIHknIChNb25kYXksIEp1bmUgMTUsIDIwMTUpLlxuICovXG5leHBvcnQgZW51bSBQcmVkZWZpbmVkRm9ybWF0T3B0aW9ucyB7XG4gICAgU2hvcnREYXRlID0gJ3Nob3J0RGF0ZScsXG4gICAgTWVkaXVtRGF0ZSA9ICdtZWRpdW1EYXRlJyxcbiAgICBMb25nRGF0ZSA9ICdsb25nRGF0ZScsXG4gICAgRnVsbERhdGUgPSAnZnVsbERhdGUnXG59XG5cbmNvbnN0IG5vb3AgPSAoKSA9PiB7IH07XG5cbi8qKlxuICogRGF0ZSBQaWNrZXIgZGlzcGxheXMgYSBwb3B1cCBjYWxlbmRhciB0aGF0IGxldHMgdXNlcnMgc2VsZWN0IGEgc2luZ2xlIGRhdGUuXG4gKkBpZ3hNb2R1bGUgSWd4RGF0ZVBpY2tlck1vZHVsZVxuICpAaWd4VGhlbWUgaWd4LWNhbGVuZGFyLXRoZW1lLCBpZ3gtaWNvbi10aGVtZVxuICpAaWd4R3JvdXAgU2NoZWR1bGluZ1xuICpAaWd4S2V5d29yZHMgIGRhdGVwaWNrZXIsIGNhbGVuZGFyLCBzY2hlZHVsZSwgZGF0ZVxuICpAZXhhbXBsZVxuICogYGBgaHRtbFxuICogPGlneC1kYXRlLXBpY2tlciBbKG5nTW9kZWwpXT1cInNlbGVjdGVkRGF0ZVwiPjwvaWd4LWRhdGUtcGlja2VyPlxuICogYGBgXG4gKi9cbkBDb21wb25lbnQoe1xuICAgIHByb3ZpZGVyczpcbiAgICAgICAgW3tcbiAgICAgICAgICAgIHByb3ZpZGU6IE5HX1ZBTFVFX0FDQ0VTU09SLFxuICAgICAgICAgICAgdXNlRXhpc3Rpbmc6IElneERhdGVQaWNrZXJDb21wb25lbnQsXG4gICAgICAgICAgICBtdWx0aTogdHJ1ZVxuICAgICAgICB9XSxcbiAgICAvLyB0c2xpbnQ6ZGlzYWJsZS1uZXh0LWxpbmU6Y29tcG9uZW50LXNlbGVjdG9yXG4gICAgc2VsZWN0b3I6ICdpZ3gtZGF0ZS1waWNrZXInLFxuICAgIHRlbXBsYXRlVXJsOiAnZGF0ZS1waWNrZXIuY29tcG9uZW50Lmh0bWwnLFxuICAgIHN0eWxlczogW2BcbiAgICAgICAgOmhvc3Qge1xuICAgICAgICAgICAgZGlzcGxheTogYmxvY2s7XG4gICAgICAgIH1cbiAgICBgXVxufSlcbmV4cG9ydCBjbGFzcyBJZ3hEYXRlUGlja2VyQ29tcG9uZW50IGltcGxlbWVudHMgSURhdGVQaWNrZXIsIENvbnRyb2xWYWx1ZUFjY2Vzc29yLFxuICAgICAgICAgIEVkaXRvclByb3ZpZGVyLCBPbkluaXQsIEFmdGVyVmlld0luaXQsIE9uRGVzdHJveSwgQWZ0ZXJWaWV3Q2hlY2tlZCB7XG4gICAgLyoqXG4gICAgICogR2V0cy9TZXRzIHRoZSBgSWd4RGF0ZVBpY2tlckNvbXBvbmVudGAgbGFiZWwuXG4gICAgICogQHJlbWFya3NcbiAgICAgKiBUaGUgZGVmYXVsdCBsYWJlbCBpcyAnRGF0ZScuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKiBgYGBodG1sXG4gICAgICogPGlneC1kYXRlLXBpY2tlciBbbGFiZWxdPVwiQ2FsZW5kYXJcIj48L2lneC1kYXRlLXBpY2tlcj5cbiAgICAgKiBgYGBcbiAgICAgKi9cbiAgICBASW5wdXQoKVxuICAgIHB1YmxpYyBsYWJlbCA9ICdEYXRlJztcblxuICAgIC8qKlxuICAgICAqIEdldHMvU2V0cyB0aGUgYElneERhdGVQaWNrZXJDb21wb25lbnRgIGxhYmVsIHZpc2liaWxpdHkuXG4gICAgICogQHJlbWFya3NcbiAgICAgKiBCeSBkZWZhdWx0IHRoZSB2aXNpYmlsaXR5IGlzIHNldCB0byB0cnVlLlxuICAgICAqIEBleGFtcGxlXG4gICAgICogPGlneC1kYXRlLXBpY2tlciBbbGFiZWxWaXNpYmlsaXR5XT1cImZhbHNlXCI+PC9pZ3gtZGF0ZS1waWNrZXI+XG4gICAgICovXG4gICAgQElucHV0KClcbiAgICBwdWJsaWMgbGFiZWxWaXNpYmlsaXR5ID0gdHJ1ZTtcblxuICAgIC8qKlxuICAgICAqR2V0cy9TZXRzIHRoZSBsb2NhbGVzLlxuICAgICAqIEByZW1hcmtzIERlZmF1bHQgbG9jYWxlIGlzIGVuLlxuICAgICAqIEBleGFtcGxlXG4gICAgICpgYGBodG1sXG4gICAgICo8aWd4LWRhdGUtcGlja2VyIGxvY2FsZT1cImphLUpQXCIgW3ZhbHVlXT1cImRhdGVcIj48L2lneC1kYXRlLXBpY2tlcj5cbiAgICAgKmBgYFxuICAgICAqL1xuICAgIEBJbnB1dCgpIHB1YmxpYyBsb2NhbGU6ICdlbic7XG5cbiAgICAvKipcbiAgICAgKkdldHMvU2V0cyBvbiB3aGljaCBkYXkgdGhlIHdlZWsgc3RhcnRzLlxuICAgICBAZXhhbXBsZVxuICAgICAqYGBgaHRtbFxuICAgICAqPGlneC1kYXRlLXBpY2tlciBbd2Vla1N0YXJ0XT1cIldFRUtEQVlTLkZSSURBWVwiIGNhbmNlbEJ1dHRvbkxhYmVsPVwiY2FuY2VsXCIgdG9kYXlCdXR0b25MYWJlbD1cInRvZGF5XCI+PC9pZ3gtZGF0ZS1waWNrZXI+XG4gICAgICpgYGBcbiAgICAgKi9cbiAgICBASW5wdXQoKSBwdWJsaWMgd2Vla1N0YXJ0OiBXRUVLREFZUyB8IG51bWJlciA9IFdFRUtEQVlTLlNVTkRBWTtcblxuICAgIC8qKlxuICAgICAqR2V0cyB0aGUgZm9ybWF0IG9wdGlvbnMgb2YgdGhlIGBJZ3hEYXRlUGlja2VyQ29tcG9uZW50YC5cbiAgICAgQGV4YW1wbGVcbiAgICAgKmBgYHR5cGVzY3JpcHRcbiAgICAgICAgbGV0IGZvcm1hdE9wdGlvbnMgPSB0aGlzLmRhdGVQaWNrZXIuZm9ybWF0T3B0aW9ucztcbiAgICAgKmBgYFxuICAgICAqL1xuICAgIEBJbnB1dCgpXG4gICAgcHVibGljIGdldCBmb3JtYXRPcHRpb25zKCk6IElGb3JtYXRPcHRpb25zIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2Zvcm1hdE9wdGlvbnM7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2V0cy9TZXRzIHdoZXRoZXIgdGhlIGluYWN0aXZlIGRhdGVzIHdpbGwgYmUgaGlkZGVuLlxuICAgICAqIEByZW1hcmtzXG4gICAgICogQXBsbGllcyB0byBkYXRlcyB0aGF0IGFyZSBvdXQgb2YgdGhlIGN1cnJlbnQgbW9udGguXG4gICAgICogRGVmYXVsdCB2YWx1ZSBpcyBgZmFsc2VgLlxuICAgICAqIEBleGFtcGxlXG4gICAgICogYGBgaHRtbFxuICAgICAqIDxpZ3gtZGF0ZS1waWNrZXIgW2hpZGVPdXRzaWRlRGF5c109XCJ0cnVlXCI+PC9pZ3gtZGF0ZS1waWNrZXI+XG4gICAgICogYGBgXG4gICAgICogQGV4YW1wbGVcbiAgICAgKiBgYGB0eXBlc2NyaXB0XG4gICAgICogbGV0IGhpZGVPdXRzaWRlRGF5cyA9IHRoaXMuZGF0ZVBpY2tlci5oaWRlT3V0c2lkZURheXM7XG4gICAgICogYGBgXG4gICAgICovXG4gICAgQElucHV0KClcbiAgICBwdWJsaWMgaGlkZU91dHNpZGVEYXlzOiBib29sZWFuO1xuXG4gICAgLyoqXG4gICAgICogR2V0cy9TZXRzIHRoZSBudW1iZXIgb2YgbW9udGggdmlld3MgZGlzcGxheWVkLlxuICAgICAqIEByZW1hcmtzXG4gICAgICogRGVmYXVsdCB2YWx1ZSBpcyBgMWAuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKiBgYGBodG1sXG4gICAgICogPGlneC1kYXRlLXBpY2tlciBbbW9udGhzVmlld051bWJlcl09XCIyXCI+PC9pZ3gtZGF0ZS1waWNrZXI+XG4gICAgICogYGBgXG4gICAgICogQGV4YW1wbGVcbiAgICAgKiBgYGB0eXBlc2NyaXB0XG4gICAgICogbGV0IG1vbnRoVmlld3NEaXNwbGF5ZWQgPSB0aGlzLmRhdGVQaWNrZXIubW9udGhzVmlld051bWJlcjtcbiAgICAgKiBgYGBcbiAgICAgKi9cbiAgICBASW5wdXQoKVxuICAgIHB1YmxpYyBtb250aHNWaWV3TnVtYmVyID0gMTtcblxuICAgIC8qKlxuICAgICAqU2V0cyB0aGUgZm9ybWF0IG9wdGlvbnMgb2YgdGhlIGBJZ3hEYXRlUGlja2VyQ29tcG9uZW50YC5cbiAgICAgKkBleGFtcGxlXG4gICAgICpgYGB0eXBlc2NyaXB0XG4gICAgICogdGhpcy5kYXRlUGlja2VyLmZvcm1hdE9wdGlvbnMgPSB7ICBkYXk6IFwibnVtZXJpY1wiLCAgbW9udGg6IFwibG9uZ1wiLCB3ZWVrZGF5OiBcImxvbmdcIiwgeWVhcjogXCJudW1lcmljXCJ9O1xuICAgICAqYGBgXG4gICAgICovXG4gICAgcHVibGljIHNldCBmb3JtYXRPcHRpb25zKGZvcm1hdE9wdGlvbnM6IElGb3JtYXRPcHRpb25zKSB7XG4gICAgICAgIHRoaXMuX2Zvcm1hdE9wdGlvbnMgPSBPYmplY3QuYXNzaWduKHRoaXMuX2Zvcm1hdE9wdGlvbnMsIGZvcm1hdE9wdGlvbnMpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqR2V0cy9TZXRzIHRoZSBkYXRlIGRpc3BsYXkgZm9ybWF0IG9mIHRoZSBgSWd4RGF0ZVBpY2tlckNvbXBvbmVudGAgaW4gZHJvcGRvd24gbW9kZS5cbiAgICAgQGV4YW1wbGVcbiAgICAgKmBgYHR5cGVzY3JpcHRcbiAgICAgKiBsZXQgZm9ybWF0ID0gdGhpcy5kYXRlUGlja2VyLmZvcm1hdDtcbiAgICAgKiB0aGlzLmRhdGVQaWNrZXIuZm9ybWF0ID0gJ3l5eXktTS1kJztcbiAgICAgKmBgYFxuICAgICAqL1xuICAgIEBJbnB1dCgpXG4gICAgcHVibGljIGdldCBmb3JtYXQoKTogc3RyaW5nIHtcbiAgICAgICAgcmV0dXJuICh0aGlzLl9mb3JtYXQgPT09IHVuZGVmaW5lZCkgPyBQcmVkZWZpbmVkRm9ybWF0T3B0aW9ucy5TaG9ydERhdGUgOiB0aGlzLl9mb3JtYXQ7XG4gICAgfVxuICAgIHB1YmxpYyBzZXQgZm9ybWF0KGZvcm1hdDogc3RyaW5nKSB7XG4gICAgICAgIHRoaXMuX2Zvcm1hdCA9IGZvcm1hdDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKkdldHMvU2V0cyB0aGUgZGF0ZSBtYXNrIG9mIHRoZSBgSWd4RGF0ZVBpY2tlckNvbXBvbmVudGAgd2hlbiBpbiBlZGl0YWJsZSBkcm9wZG93biBtb2RlLlxuICAgICAqQGV4YW1wbGVcbiAgICAgKmBgYHR5cGVzY3JpcHRcbiAgICAgKmxldCBtYXNrID0gdGhpcy5kYXRlUGlja2VyLm1hc2s7XG4gICAgICpgYGBcbiAgICAgKi9cbiAgICBASW5wdXQoKVxuICAgIHB1YmxpYyBtYXNrOiBzdHJpbmc7XG5cbiAgICAvKipcbiAgICAgKkdldHMvU2V0cyB0aGUgZm9ybWF0IHZpZXdzIG9mIHRoZSBgSWd4RGF0ZVBpY2tlckNvbXBvbmVudGAuXG4gICAgICpAZXhhbXBsZVxuICAgICAqYGBgdHlwZXNjcmlwdFxuICAgICAqIGxldCBmb3JtYXRWaWV3cyA9IHRoaXMuZGF0ZVBpY2tlci5mb3JtYXRWaWV3cztcbiAgICAgKiAgdGhpcy5kYXRlUGlja2VyLmZvcm1hdFZpZXdzID0ge2RheTpmYWxzZSwgbW9udGg6IGZhbHNlLCB5ZWFyOmZhbHNlfTtcbiAgICAgKmBgYFxuICAgICAqL1xuICAgIEBJbnB1dCgpXG4gICAgcHVibGljIGdldCBmb3JtYXRWaWV3cygpOiBJRm9ybWF0Vmlld3Mge1xuICAgICAgICByZXR1cm4gdGhpcy5fZm9ybWF0Vmlld3M7XG4gICAgfVxuXG4gICAgcHVibGljIHNldCBmb3JtYXRWaWV3cyhmb3JtYXRWaWV3czogSUZvcm1hdFZpZXdzKSB7XG4gICAgICAgIHRoaXMuX2Zvcm1hdFZpZXdzID0gT2JqZWN0LmFzc2lnbih0aGlzLl9mb3JtYXRWaWV3cywgZm9ybWF0Vmlld3MpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldHMvU2V0cyB0aGUgZGlzYWJsZWQgZGF0ZXMgZGVzY3JpcHRvcnMuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKiBgYGB0eXBlc2NyaXB0XG4gICAgICogbGV0IGRpc2FibGVkRGF0ZXMgPSB0aGlzLmRhdGVwaWNrZXIuZGlzYWJsZWREYXRlcztcbiAgICAgKiB0aGlzLmRhdGVQaWNrZXIuZGlzYWJsZWREYXRlcyA9IFsge3R5cGU6IERhdGVSYW5nZVR5cGUuV2Vla2VuZHN9LCAuLi5dO1xuICAgICAqIGBgYFxuICAgICAqL1xuICAgIEBJbnB1dCgpXG4gICAgcHVibGljIGdldCBkaXNhYmxlZERhdGVzKCk6IERhdGVSYW5nZURlc2NyaXB0b3JbXSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9kaXNhYmxlZERhdGVzO1xuICAgIH1cbiAgICBwdWJsaWMgc2V0IGRpc2FibGVkRGF0ZXModmFsdWU6IERhdGVSYW5nZURlc2NyaXB0b3JbXSkge1xuICAgICAgICB0aGlzLl9kaXNhYmxlZERhdGVzID0gdmFsdWU7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2V0cy9TZXRzIHRoZSBzcGVjaWFsIGRhdGVzIGRlc2NyaXB0b3JzLlxuICAgICAqIEBleGFtcGxlXG4gICAgICogYGBgdHlwZXNjcmlwdFxuICAgICAqIGxldCBzcGVjaWFsRGF0ZXMgPSB0aGlzLmRhdGVwaWNrZXIuc3BlY2lhbERhdGVzO1xuICAgICAqIHRoaXMuZGF0ZVBpY2tlci5zcGVjaWFsRGF0ZXMgPSBbIHt0eXBlOiBEYXRlUmFuZ2VUeXBlLldlZWtlbmRzfSwgLi4uIF07XG4gICAgICogYGBgXG4gICAgICovXG4gICAgQElucHV0KClcbiAgICBwdWJsaWMgZ2V0IHNwZWNpYWxEYXRlcygpOiBEYXRlUmFuZ2VEZXNjcmlwdG9yW10ge1xuICAgICAgICByZXR1cm4gdGhpcy5fc3BlY2lhbERhdGVzO1xuICAgIH1cbiAgICBwdWJsaWMgc2V0IHNwZWNpYWxEYXRlcyh2YWx1ZTogRGF0ZVJhbmdlRGVzY3JpcHRvcltdKSB7XG4gICAgICAgIHRoaXMuX3NwZWNpYWxEYXRlcyA9IHZhbHVlO1xuICAgIH1cblxuICAgIC8qKlxuICAgICogR2V0cy9TZXRzIHRoZSBtb2RhbCBvdmVybGF5IHNldHRpbmdzLlxuICAgICovXG4gICAgQElucHV0KClcbiAgICBwdWJsaWMgZ2V0IG1vZGFsT3ZlcmxheVNldHRpbmdzKCk6IE92ZXJsYXlTZXR0aW5ncyB7XG4gICAgICAgIHJldHVybiB0aGlzLl9tb2RhbE92ZXJsYXk7XG4gICAgfVxuXG4gICAgcHVibGljIHNldCBtb2RhbE92ZXJsYXlTZXR0aW5ncyh2YWx1ZTogT3ZlcmxheVNldHRpbmdzKSB7XG4gICAgICAgIHRoaXMuX21vZGFsT3ZlcmxheSA9IHZhbHVlO1xuICAgIH1cblxuICAgIC8qKlxuICAgICogR2V0cy9TZXRzIHRoZSBkcm9wLWRvd24gb3ZlcmxheSBzZXR0aW5ncy5cbiAgICAqL1xuICAgIEBJbnB1dCgpXG4gICAgcHVibGljIGdldCBkcm9wRG93bk92ZXJsYXlTZXR0aW5ncygpOiBPdmVybGF5U2V0dGluZ3Mge1xuICAgICAgICByZXR1cm4gdGhpcy5fZHJvcERvd25PdmVybGF5U2V0dGluZ3MgfHwgdGhpcy5fZGVmYXVsdERyb3BEb3duT3ZlcmxheVNldHRpbmdzO1xuICAgIH1cblxuICAgIHB1YmxpYyBzZXQgZHJvcERvd25PdmVybGF5U2V0dGluZ3ModmFsdWU6IE92ZXJsYXlTZXR0aW5ncykge1xuICAgICAgICB0aGlzLl9kcm9wRG93bk92ZXJsYXlTZXR0aW5ncyA9IHZhbHVlO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqR2V0cyB0aGUgZm9ybWF0dGVkIGRhdGUgd2hlbiBgSWd4RGF0ZVBpY2tlckNvbXBvbmVudGAgaXMgaW4gZGlhbG9nIG1vZGUuXG4gICAgICpAZXhhbXBsZVxuICAgICAqYGBgdHlwZXNjcmlwdFxuICAgICAqbGV0IHNlbGVjdGVkRGF0ZSA9IHRoaXMuZGF0ZVBpY2tlci5kaXNwbGF5RGF0YTtcbiAgICAgKmBgYFxuICAgICAqL1xuICAgIHB1YmxpYyBnZXQgZGlzcGxheURhdGEoKTogc3RyaW5nIHtcbiAgICAgICAgaWYgKHRoaXMudmFsdWUpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9jdXN0b21Gb3JtYXRDaGVja2VyKHRoaXMuZm9ybWF0dGVyLCB0aGlzLnZhbHVlKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gJyc7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgIEBoaWRkZW4gQGludGVybmFsXG4gICAgICovXG4gICAgcHVibGljIGdldCB0cmFuc2Zvcm1lZERhdGUoKTogc3RyaW5nIHtcbiAgICAgICAgaWYgKHRoaXMuX3ZhbHVlKSB7XG4gICAgICAgICAgICB0aGlzLl90cmFuc2Zvcm1lZERhdGUgPSAodGhpcy5faXNJbkVkaXRNb2RlKSA/IHRoaXMuX2dldEVkaXRvckRhdGUodGhpcy5fdmFsdWUpIDogdGhpcy5fZ2V0RGlzcGxheURhdGUodGhpcy5fdmFsdWUpO1xuICAgICAgICAgICAgdGhpcy5pc0VtcHR5ID0gZmFsc2U7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLl90cmFuc2Zvcm1lZERhdGUgPSAodGhpcy5faXNJbkVkaXRNb2RlKSA/IERhdGVQaWNrZXJVdGlsLm1hc2tUb1Byb21wdENoYXJzKHRoaXMuaW5wdXRNYXNrKSA6ICcnO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzLl90cmFuc2Zvcm1lZERhdGU7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgIEBoaWRkZW4gQGludGVybmFsXG4gICAgICovXG4gICAgcHVibGljIHNldCB0cmFuc2Zvcm1lZERhdGUodmFsdWUpIHtcbiAgICAgICAgdGhpcy5fdHJhbnNmb3JtZWREYXRlID0gdmFsdWU7XG4gICAgfVxuXG4gICAgY29uc3RydWN0b3IoQEluamVjdChcbiAgICAgICAgSWd4T3ZlcmxheVNlcnZpY2UpIHByaXZhdGUgX292ZXJsYXlTZXJ2aWNlOiBJZ3hPdmVybGF5U2VydmljZSxcbiAgICAgICAgcHVibGljIGVsZW1lbnQ6IEVsZW1lbnRSZWYsXG4gICAgICAgIHByaXZhdGUgX2NkcjogQ2hhbmdlRGV0ZWN0b3JSZWYsXG4gICAgICAgIHByaXZhdGUgX21vZHVsZVJlZjogTmdNb2R1bGVSZWY8YW55PixcbiAgICAgICAgcHJpdmF0ZSBfaW5qZWN0b3I6IEluamVjdG9yKSB7IH1cblxuICAgIC8qKlxuICAgICAqIEdldHMgdGhlIGlucHV0IGdyb3VwIHRlbXBsYXRlLlxuICAgICAqIEBleGFtcGxlXG4gICAgICogYGBgdHlwZXNjcmlwdFxuICAgICAqIGxldCB0ZW1wbGF0ZSA9IHRoaXMudGVtcGxhdGUoKTtcbiAgICAgKiBgYGBcbiAgICAgKi9cbiAgICBnZXQgdGVtcGxhdGUoKTogVGVtcGxhdGVSZWY8YW55PiB7XG4gICAgICAgIGlmICh0aGlzLmRhdGVQaWNrZXJUZW1wbGF0ZURpcmVjdGl2ZSkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuZGF0ZVBpY2tlclRlbXBsYXRlRGlyZWN0aXZlLnRlbXBsYXRlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiAodGhpcy5tb2RlID09PSBJbnRlcmFjdGlvbk1vZGUuRGlhbG9nKSA/IHRoaXMucmVhZE9ubHlEYXRlUGlja2VyVGVtcGxhdGUgOiB0aGlzLmVkaXRhYmxlRGF0ZVBpY2tlclRlbXBsYXRlO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdldHMgdGhlIGNvbnRleHQgcGFzc2VkIHRvIHRoZSBpbnB1dCBncm91cCB0ZW1wbGF0ZS5cbiAgICAgKi9cbiAgICBnZXQgY29udGV4dCgpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGRpc2FibGVkOiB0aGlzLmRpc2FibGVkLFxuICAgICAgICAgICAgZGlzYWJsZWREYXRlczogdGhpcy5kaXNhYmxlZERhdGVzLFxuICAgICAgICAgICAgZGlzcGxheURhdGE6IHRoaXMuZGlzcGxheURhdGEsXG4gICAgICAgICAgICBmb3JtYXQ6IHRoaXMuZm9ybWF0LFxuICAgICAgICAgICAgaXNTcGluTG9vcDogdGhpcy5pc1NwaW5Mb29wLFxuICAgICAgICAgICAgbGFiZWw6IHRoaXMubGFiZWwsXG4gICAgICAgICAgICBsYWJlbFZpc2liaWxpdHk6IHRoaXMubGFiZWxWaXNpYmlsaXR5LFxuICAgICAgICAgICAgbG9jYWxlOiB0aGlzLmxvY2FsZSxcbiAgICAgICAgICAgIG1hc2s6IHRoaXMubWFzayxcbiAgICAgICAgICAgIG1vZGU6IHRoaXMubW9kZSxcbiAgICAgICAgICAgIHNwZWNpYWxEYXRlczogdGhpcy5zcGVjaWFsRGF0ZXMsXG4gICAgICAgICAgICB2YWx1ZTogdGhpcy52YWx1ZSxcbiAgICAgICAgICAgIG9wZW5EaWFsb2c6ICh0YXJnZXQ/OiBIVE1MRWxlbWVudCkgPT4gdGhpcy5vcGVuRGlhbG9nKHRhcmdldClcbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICBwcml2YXRlIGdldCByZXF1aXJlZCgpOiBib29sZWFuIHtcbiAgICAgICAgaWYgKHRoaXMuX25nQ29udHJvbCAmJiB0aGlzLl9uZ0NvbnRyb2wuY29udHJvbCAmJiB0aGlzLl9uZ0NvbnRyb2wuY29udHJvbC52YWxpZGF0b3IpIHtcbiAgICAgICAgICAgIC8vIFJ1biB0aGUgdmFsaWRhdGlvbiB3aXRoIGVtcHR5IG9iamVjdCB0byBjaGVjayBpZiByZXF1aXJlZCBpcyBlbmFibGVkLlxuICAgICAgICAgICAgY29uc3QgZXJyb3IgPSB0aGlzLl9uZ0NvbnRyb2wuY29udHJvbC52YWxpZGF0b3Ioe30gYXMgQWJzdHJhY3RDb250cm9sKTtcbiAgICAgICAgICAgIHJldHVybiBlcnJvciAmJiBlcnJvci5yZXF1aXJlZDtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cblxuICAgIC8qKlxuICAgICAqR2V0cy9TZXRzIHRoZSBzZWxlY3RlZCBkYXRlLlxuICAgICAqQGV4YW1wbGVcbiAgICAgKmBgYGh0bWxcbiAgICAgKjxpZ3gtZGF0ZS1waWNrZXIgW3ZhbHVlXT1cImRhdGVcIj48L2lneC1kYXRlLXBpY2tlcj5cbiAgICAgKmBgYFxuICAgICAqL1xuICAgIEBJbnB1dCgpXG4gICAgcHVibGljIGdldCB2YWx1ZSgpOiBEYXRlIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3ZhbHVlO1xuICAgIH1cblxuICAgIHB1YmxpYyBzZXQgdmFsdWUoZGF0ZTogRGF0ZSkge1xuICAgICAgICB0aGlzLl92YWx1ZSA9IGRhdGU7XG4gICAgICAgIHRoaXMuX29uQ2hhbmdlQ2FsbGJhY2soZGF0ZSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICpHZXRzL1NldHMgdGhlIHZhbHVlIG9mIGBpZGAgYXR0cmlidXRlLlxuICAgICAqQHJlbWFya3MgSWYgbm90IHByb3ZpZGVkIGl0IHdpbGwgYmUgYXV0b21hdGljYWxseSBnZW5lcmF0ZWQuXG4gICAgICpAZXhhbXBsZVxuICAgICAqYGBgaHRtbFxuICAgICAqPGlneC1kYXRlLXBpY2tlciBbaWRdPVwiJ2lneC1kYXRlLXBpY2tlci0zJ1wiIGNhbmNlbEJ1dHRvbkxhYmVsPVwiY2FuY2VsXCIgdG9kYXlCdXR0b25MYWJlbD1cInRvZGF5XCI+PC9pZ3gtZGF0ZS1waWNrZXI+XG4gICAgICpgYGBcbiAgICAgKi9cbiAgICBASG9zdEJpbmRpbmcoJ2F0dHIuaWQnKVxuICAgIEBJbnB1dCgpXG4gICAgcHVibGljIGlkID0gYGlneC1kYXRlLXBpY2tlci0ke05FWFRfSUQrK31gO1xuXG4gICAgLyoqXG4gICAgICogR2V0cy9TZXRzIGEgY3VzdG9tIGZvcm1hdHRlciBmdW5jdGlvbiBvbiB0aGUgc2VsZWN0ZWQgb3IgcGFzc2VkIGRhdGUuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKmBgYGh0bWxcbiAgICAgKjxpZ3gtZGF0ZS1waWNrZXIgW3ZhbHVlXT1cImRhdGVcIiBbZm9ybWF0dGVyXT1cImZvcm1hdHRlclwiPjwvaWd4LWRhdGUtcGlja2VyPlxuICAgICAqYGBgXG4gICAgICovXG4gICAgQElucHV0KClcbiAgICBwdWJsaWMgZm9ybWF0dGVyOiAodmFsOiBEYXRlKSA9PiBzdHJpbmc7XG5cbiAgICAvKipcbiAgICAgKkVuYWJsZXMvRGlzYWJsZXMgdGhlIGBJZ3hEYXRlUGlja2VyQ29tcG9uZW50YC5cbiAgICAgKkBleGFtcGxlXG4gICAgICpgYGBodG1sXG4gICAgICo8aWd4LWRhdGUtcGlja2VyIFtkaXNhYmxlZF09XCIndHJ1ZSdcIiBjYW5jZWxCdXR0b25MYWJlbD1cImNhbmNlbFwiIHRvZGF5QnV0dG9uTGFiZWw9XCJ0b2RheVwiPjwvaWd4LWRhdGUtcGlja2VyPlxuICAgICAqIGBgYFxuICAgICAqL1xuICAgIEBJbnB1dCgpXG4gICAgcHVibGljIGRpc2FibGVkOiBib29sZWFuO1xuXG4gICAgLyoqXG4gICAgICpHZXRzL1NldHMgdGhlIG9yaWVudGF0aW9uIG9mIHRoZSBgSWd4RGF0ZVBpY2tlckNvbXBvbmVudGAgaGVhZGVyLlxuICAgICAqQGV4YW1wbGVcbiAgICAgKmBgYGh0bWxcbiAgICAgKjxpZ3gtZGF0ZS1waWNrZXIgW3ZlcnRpY2FsXT1cIid0cnVlJ1wiIGNhbmNlbEJ1dHRvbkxhYmVsPVwiY2FuY2VsXCIgdG9kYXlCdXR0b25MYWJlbD1cInRvZGF5XCI+PC9pZ3gtZGF0ZS1waWNrZXI+XG4gICAgICpgYGBcbiAgICAgKi9cbiAgICBASW5wdXQoKVxuICAgIHB1YmxpYyB2ZXJ0aWNhbCA9IGZhbHNlO1xuXG4gICAgLyoqXG4gICAgICpHZXRzL1NldHMgdGhlIHRvZGF5IGJ1dHRvbidzIGxhYmVsLlxuICAgICAqQGV4YW1wbGVcbiAgICAgKmBgYGh0bWxcbiAgICAgKjxpZ3gtZGF0ZS1waWNrZXIgY2FuY2VsQnV0dG9uTGFiZWw9XCJjYW5jZWxcIiB0b2RheUJ1dHRvbkxhYmVsPVwiVG9tb3Jyb3dcIj48L2lneC1kYXRlLXBpY2tlcj5cbiAgICAgKmBgYFxuICAgICAqL1xuICAgIEBJbnB1dCgpXG4gICAgcHVibGljIHRvZGF5QnV0dG9uTGFiZWw6IHN0cmluZztcblxuICAgIC8qKlxuICAgICAqICpHZXRzL1NldHMgdGhlIGNhbmNlbCBidXR0b24ncyBsYWJlbC5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqYGBgaHRtbFxuICAgICAqPGlneC1kYXRlLXBpY2tlciBjYW5jZWxCdXR0b25MYWJlbD1cIkNsb3NlXCIgdG9kYXlCdXR0b25MYWJlbD1cIlRvZGF5XCI+PC9pZ3gtZGF0ZS1waWNrZXI+XG4gICAgICpgYGBcbiAgICAgKi9cbiAgICBASW5wdXQoKVxuICAgIHB1YmxpYyBjYW5jZWxCdXR0b25MYWJlbDogc3RyaW5nO1xuXG4gICAgLyoqXG4gICAgICpHZXRzL1NldHMgdGhlIGludGVyYWN0aW9uIG1vZGUgLSBkaWFsb2cgb3IgZHJvcCBkb3duLlxuICAgICAqQGV4YW1wbGVcbiAgICAgKmBgYGh0bWxcbiAgICAgKjxpZ3gtZGF0ZS1waWNrZXIgbW9kZT1cImRyb3Bkb3duXCI+PC9pZ3gtZGF0ZS1waWNrZXI+XG4gICAgICpgYGBcbiAgICAgKi9cbiAgICBASW5wdXQoKVxuICAgIHB1YmxpYyBtb2RlID0gSW50ZXJhY3Rpb25Nb2RlLkRpYWxvZztcblxuICAgIC8qKlxuICAgICAqR2V0cy9TZXRzIHdoZXRoZXIgZGF0ZSBzaG91bGQgc3BpbiBjb250aW51b3VzbHkgb3Igc3RvcCB3aGVuIG1pbi9tYXggaXMgcmVhY2hlZC5cbiAgICAgKkBleGFtcGxlXG4gICAgICpgYGBodG1sXG4gICAgICo8aWd4LWRhdGUtcGlja2VyIFtpc1NwaW5Mb29wXT1cImZhbHNlXCI+PC9pZ3gtZGF0ZS1waWNrZXI+XG4gICAgICpgYGBcbiAgICAgKi9cbiAgICBASW5wdXQoKVxuICAgIHB1YmxpYyBpc1NwaW5Mb29wID0gdHJ1ZTtcblxuICAgIC8qKlxuICAgICAqIEdldHMvU2V0cyB0aGUgY29udGFpbmVyIHVzZWQgZm9yIHRoZSBwb3B1cCBlbGVtZW50LlxuICAgICAqIEByZW1hcmtzXG4gICAgICogIGBvdXRsZXRgIGlzIGFuIGluc3RhbmNlIG9mIGBJZ3hPdmVybGF5T3V0bGV0RGlyZWN0aXZlYCBvciBhbiBgRWxlbWVudFJlZmAuXG4gICAgICpAZXhhbXBsZVxuICAgICAqIGBgYGh0bWxcbiAgICAgKiA8ZGl2IGlneE92ZXJsYXlPdXRsZXQgI291dGxldD1cIm92ZXJsYXktb3V0bGV0XCI+PC9kaXY+XG4gICAgICogLy8uLlxuICAgICAqIDxpZ3gtZGF0ZS1waWNrZXIgW291dGxldF09XCJvdXRsZXRcIj48L2lneC1kYXRlLXBpY2tlcj5cbiAgICAgKiAvLy4uXG4gICAgICogYGBgXG4gICAgICovXG4gICAgQElucHV0KClcbiAgICBwdWJsaWMgb3V0bGV0OiBJZ3hPdmVybGF5T3V0bGV0RGlyZWN0aXZlIHwgRWxlbWVudFJlZjtcblxuICAgIC8qKlxuICAgICAqIEBkZXByZWNhdGVkIFVzZSAnb25PcGVuZWQnIGluc3RlYWQuXG4gICAgICpBbiBldmVudCB0aGF0IGlzIGVtaXR0ZWQgd2hlbiB0aGUgYElneERhdGVQaWNrZXJDb21wb25lbnRgIGNhbGVuZGFyIGlzIG9wZW5lZC5cbiAgICAgKkBleGFtcGxlXG4gICAgICpgYGB0eXBlc2NyaXB0XG4gICAgICpwdWJsaWMgb3BlbihldmVudCl7XG4gICAgICogICAgYWxlcnQoXCJUaGUgZGF0ZS1waWNrZXIgY2FsZW5kYXIgaGFzIGJlZW4gb3BlbmVkIVwiKTtcbiAgICAgKn1cbiAgICAgKmBgYFxuICAgICAqYGBgaHRtbFxuICAgICAqPGlneC1kYXRlLXBpY2tlciAob25PcGVuKT1cIm9wZW4oJGV2ZW50KVwiIGNhbmNlbEJ1dHRvbkxhYmVsPVwiY2FuY2VsXCIgdG9kYXlCdXR0b25MYWJlbD1cInRvZGF5XCI+PC9pZ3gtZGF0ZS1waWNrZXI+XG4gICAgICpgYGBcbiAgICAgKi9cbiAgICBARGVwcmVjYXRlUHJvcGVydHkoYCdvbk9wZW4nIEBPdXRwdXQgcHJvcGVydHkgaXMgZGVwcmVjYXRlZC4gVXNlICdvbk9wZW5lZCcgaW5zdGVhZC5gKVxuICAgIEBPdXRwdXQoKVxuICAgIHB1YmxpYyBnZXQgb25PcGVuKCk6IEV2ZW50RW1pdHRlcjxJZ3hEYXRlUGlja2VyQ29tcG9uZW50PiB7XG4gICAgICAgIHJldHVybiB0aGlzLl9vbk9wZW47XG4gICAgfVxuXG4gICAgcHVibGljIHNldCBvbk9wZW4odmFsOiBFdmVudEVtaXR0ZXI8SWd4RGF0ZVBpY2tlckNvbXBvbmVudD4pIHtcbiAgICAgICAgdGhpcy5fb25PcGVuID0gdmFsO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqRW1pdHRlZCB3aGVuIHRoZSBgSWd4RGF0ZVBpY2tlckNvbXBvbmVudGAgY2FsZW5kYXIgaXMgb3BlbmVkLlxuICAgICovXG4gICAgQE91dHB1dCgpXG4gICAgcHVibGljIG9uT3BlbmVkID0gbmV3IEV2ZW50RW1pdHRlcjxJZ3hEYXRlUGlja2VyQ29tcG9uZW50PigpO1xuXG4gICAgLyoqXG4gICAgICogQGRlcHJlY2F0ZWQgVXNlICdvbkNsb3NlZCcgaW5zdGVhZC5cbiAgICAgKlwiQW4gZXZlbnQgdGhhdCBpcyBlbWl0dGVkIHdoZW4gdGhlIGBJZ3hEYXRlUGlja2VyQ29tcG9uZW50YCBpcyBjbG9zZWQuXG4gICAgICpAZXhhbXBsZVxuICAgICAqYGBgdHlwZXNjcmlwdFxuICAgICAqcHVibGljIGNsb3NlKGV2ZW50KXtcbiAgICAgKiAgICBhbGVydChcIlRoZSBkYXRlLXBpY2tlciBoYXMgYmVlbiBjbG9zZWQhXCIpO1xuICAgICAqfVxuICAgICAqYGBgXG4gICAgICpgYGBodG1sXG4gICAgICo8aWd4LWRhdGUtcGlja2VyIChvbkNsb3NlKT1cImNsb3NlKCRldmVudClcIiBjYW5jZWxCdXR0b25MYWJlbD1cImNhbmNlbFwiIHRvZGF5QnV0dG9uTGFiZWw9XCJ0b2RheVwiPjwvaWd4LWRhdGUtcGlja2VyPlxuICAgICAqYGBgXG4gICAgICovXG4gICAgQERlcHJlY2F0ZVByb3BlcnR5KGAnb25DbG9zZScgQE91dHB1dCBwcm9wZXJ0eSBpcyBkZXByZWNhdGVkLiBVc2UgJ29uQ2xvc2VkJyBpbnN0ZWFkLmApXG4gICAgQE91dHB1dCgpXG4gICAgcHVibGljIGdldCBvbkNsb3NlKCk6IEV2ZW50RW1pdHRlcjxJZ3hEYXRlUGlja2VyQ29tcG9uZW50PiB7XG4gICAgICAgIHJldHVybiB0aGlzLl9vbkNsb3NlO1xuICAgIH1cblxuICAgIHB1YmxpYyBzZXQgb25DbG9zZSh2YWw6IEV2ZW50RW1pdHRlcjxJZ3hEYXRlUGlja2VyQ29tcG9uZW50Pikge1xuICAgICAgICB0aGlzLl9vbkNsb3NlID0gdmFsO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqRW1pdHRlZCBhZnRlciB0aGUgYElneERhdGVQaWNrZXJDb21wb25lbnRgIGlzIGNsb3NlZC5cbiAgICAqL1xuICAgIEBPdXRwdXQoKVxuICAgIHB1YmxpYyBvbkNsb3NlZCA9IG5ldyBFdmVudEVtaXR0ZXI8SWd4RGF0ZVBpY2tlckNvbXBvbmVudD4oKTtcblxuICAgIC8qKlxuICAgICAqRW1pdHRlZCB3aGVuIHRoZSBgSWd4RGF0ZVBpY2tlckNvbXBvbmVudGAgaXMgYmVpbmcgY2xvc2VkLlxuICAgICAqL1xuICAgIEBPdXRwdXQoKVxuICAgIHB1YmxpYyBvbkNsb3NpbmcgPSBuZXcgRXZlbnRFbWl0dGVyPENhbmNlbGFibGVCcm93c2VyRXZlbnRBcmdzICYgSUJhc2VFdmVudEFyZ3M+KCk7XG5cbiAgICAvKipcbiAgICAgKkVtaXR0ZWQgd2hlbiBzZWxlY3Rpb24gaXMgbWFkZSBpbiB0aGUgY2FsZW5kYXIuXG4gICAgICpAZXhhbXBsZVxuICAgICAqYGBgaHRtbFxuICAgICAqPGlneC1kYXRlLXBpY2tlciAob25TZWxlY3Rpb24pPVwic2VsZWN0aW9uKCRldmVudClcIj48L2lneC1kYXRlLXBpY2tlcj5cbiAgICAgKmBgYFxuICAgICAqL1xuICAgIEBPdXRwdXQoKVxuICAgIHB1YmxpYyBvblNlbGVjdGlvbiA9IG5ldyBFdmVudEVtaXR0ZXI8RGF0ZT4oKTtcblxuICAgIC8qKlxuICAgICAqRW1pdHRlZCB3aGVuIGRhdGUgcGlja2VyIHZhbHVlIGlzIGNoYW5nZWQuXG4gICAgICpAZXhhbXBsZVxuICAgICpgYGBodG1sXG4gICAgKjxpZ3gtZGF0ZS1waWNrZXIgKHZhbHVlQ2hhbmdlKT1cInZhbHVlQ2hhbmdlZCgkZXZlbnQpXCIgbW9kZT1cImRyb3Bkb3duXCI+PC9pZ3gtZGF0ZS1waWNrZXI+XG4gICAgKmBgYFxuICAgICovXG4gICAgQE91dHB1dCgpXG4gICAgcHVibGljIHZhbHVlQ2hhbmdlID0gbmV3IEV2ZW50RW1pdHRlcjxEYXRlPigpO1xuXG4gICAgLyoqXG4gICAgKkVtaXR0ZWQgd2hlbiB0aGUgdXNlciB0eXBlcy9zcGlucyB0byBhIGRpc2FibGVkIGRhdGUgaW4gdGhlIGRhdGUtcGlja2VyIGVkaXRvci5cbiAgICAqQGV4YW1wbGVcbiAgICAqYGBgaHRtbFxuICAgICo8aWd4LWRhdGUtcGlja2VyIChvbkRpc2FibGVkRGF0ZSk9XCJvbkRpc2FibGVkRGF0ZSgkZXZlbnQpXCI+PC9pZ3gtZGF0ZS1waWNrZXI+XG4gICAgKmBgYFxuICAgICovXG4gICAgQE91dHB1dCgpXG4gICAgcHVibGljIG9uRGlzYWJsZWREYXRlID0gbmV3IEV2ZW50RW1pdHRlcjxJRGF0ZVBpY2tlckRpc2FibGVkRGF0ZUV2ZW50QXJncz4oKTtcblxuICAgIC8qKlxuICAgICpFbWl0dGVkIHdoZW4gdGhlIHVzZXIgdHlwZXMvc3BpbnMgaW52YWxpZCBkYXRlIGluIHRoZSBkYXRlLXBpY2tlciBlZGl0b3IuXG4gICAgKkBleGFtcGxlXG4gICAgKmBgYGh0bWxcbiAgICAqPGlneC1kYXRlLXBpY2tlciAob25WYWxpZGF0aW9uRmFpbGVkKT1cIm9uVmFsaWRhdGlvbkZhaWxlZCgkZXZlbnQpXCI+PC9pZ3gtZGF0ZS1waWNrZXI+XG4gICAgKmBgYFxuICAgICovXG4gICAgQE91dHB1dCgpXG4gICAgcHVibGljIG9uVmFsaWRhdGlvbkZhaWxlZCA9IG5ldyBFdmVudEVtaXR0ZXI8SURhdGVQaWNrZXJWYWxpZGF0aW9uRmFpbGVkRXZlbnRBcmdzPigpO1xuXG4gICAgLypcbiAgICAgKiBAaGlkZGVuXG4gICAgICovXG4gICAgQFZpZXdDaGlsZCgncmVhZE9ubHlEYXRlUGlja2VyVGVtcGxhdGUnLCB7IHJlYWQ6IFRlbXBsYXRlUmVmLCBzdGF0aWM6IHRydWUgfSlcbiAgICBwcm90ZWN0ZWQgcmVhZE9ubHlEYXRlUGlja2VyVGVtcGxhdGU6IFRlbXBsYXRlUmVmPGFueT47XG5cbiAgICAvKlxuICAgICAqIEBoaWRkZW5cbiAgICAgKi9cbiAgICBAVmlld0NoaWxkKCdlZGl0YWJsZURhdGVQaWNrZXJUZW1wbGF0ZScsIHsgcmVhZDogVGVtcGxhdGVSZWYsIHN0YXRpYzogdHJ1ZSB9KVxuICAgIHByb3RlY3RlZCBlZGl0YWJsZURhdGVQaWNrZXJUZW1wbGF0ZTogVGVtcGxhdGVSZWY8YW55PjtcblxuICAgIC8qXG4gICAgICogQGhpZGRlblxuICAgICAqL1xuICAgIEBWaWV3Q2hpbGQoSWd4SW5wdXRHcm91cENvbXBvbmVudClcbiAgICBwcm90ZWN0ZWQgaW5wdXRHcm91cDogSWd4SW5wdXRHcm91cENvbXBvbmVudDtcblxuICAgIEBWaWV3Q2hpbGQoSWd4SW5wdXREaXJlY3RpdmUsIHsgcmVhZDogRWxlbWVudFJlZiB9KVxuICAgIHByaXZhdGUgX2lucHV0RWxlbWVudFJlZjogRWxlbWVudFJlZjtcblxuICAgIEBDb250ZW50Q2hpbGQoSWd4SW5wdXREaXJlY3RpdmUsIHsgcmVhZDogRWxlbWVudFJlZiB9KVxuICAgIHByb3RlY3RlZCBfaW5wdXRVc2VyVGVtcGxhdGVFbGVtZW50UmVmOiBFbGVtZW50UmVmO1xuXG4gICAgQFZpZXdDaGlsZChJZ3hJbnB1dERpcmVjdGl2ZSlcbiAgICBwcml2YXRlIF9pbnB1dERpcmVjdGl2ZTogSWd4SW5wdXREaXJlY3RpdmU7XG5cbiAgICBAQ29udGVudENoaWxkKElneElucHV0RGlyZWN0aXZlKVxuICAgIHByaXZhdGUgX2lucHV0RGlyZWN0aXZlVXNlclRlbXBsYXRlOiBJZ3hJbnB1dERpcmVjdGl2ZTtcblxuICAgIC8qKlxuICAgICAqQGhpZGRlblxuICAgICAqL1xuICAgIEBDb250ZW50Q2hpbGQoSWd4RGF0ZVBpY2tlclRlbXBsYXRlRGlyZWN0aXZlLCB7IHJlYWQ6IElneERhdGVQaWNrZXJUZW1wbGF0ZURpcmVjdGl2ZSB9KVxuICAgIHByb3RlY3RlZCBkYXRlUGlja2VyVGVtcGxhdGVEaXJlY3RpdmU6IElneERhdGVQaWNrZXJUZW1wbGF0ZURpcmVjdGl2ZTtcblxuICAgIC8qKlxuICAgICAqQGhpZGRlblxuICAgICAqL1xuICAgIEBDb250ZW50Q2hpbGQoSWd4Q2FsZW5kYXJIZWFkZXJUZW1wbGF0ZURpcmVjdGl2ZSwgeyByZWFkOiBJZ3hDYWxlbmRhckhlYWRlclRlbXBsYXRlRGlyZWN0aXZlIH0pXG4gICAgcHVibGljIGhlYWRlclRlbXBsYXRlOiBJZ3hDYWxlbmRhckhlYWRlclRlbXBsYXRlRGlyZWN0aXZlO1xuXG4gICAgLyoqXG4gICAgICpAaGlkZGVuXG4gICAgICovXG4gICAgQENvbnRlbnRDaGlsZChJZ3hDYWxlbmRhclN1YmhlYWRlclRlbXBsYXRlRGlyZWN0aXZlLCB7IHJlYWQ6IElneENhbGVuZGFyU3ViaGVhZGVyVGVtcGxhdGVEaXJlY3RpdmUgfSlcbiAgICBwdWJsaWMgc3ViaGVhZGVyVGVtcGxhdGU6IElneENhbGVuZGFyU3ViaGVhZGVyVGVtcGxhdGVEaXJlY3RpdmU7XG5cbiAgICAvKipcbiAgICAgKkBoaWRkZW5cbiAgICAgKi9cbiAgICBAQ29udGVudENoaWxkKElneERhdGVQaWNrZXJBY3Rpb25zRGlyZWN0aXZlLCB7IHJlYWQ6IElneERhdGVQaWNrZXJBY3Rpb25zRGlyZWN0aXZlIH0pXG4gICAgcHVibGljIGRhdGVQaWNrZXJBY3Rpb25zRGlyZWN0aXZlOiBJZ3hEYXRlUGlja2VyQWN0aW9uc0RpcmVjdGl2ZTtcblxuICAgIC8qKkBoaWRkZW4gQGludGVybmFsKi9cbiAgICBwdWJsaWMgY2FsZW5kYXI6IElneENhbGVuZGFyQ29tcG9uZW50O1xuICAgIC8qKkBoaWRkZW4gQGludGVybmFsKi9cbiAgICBwdWJsaWMgaGFzSGVhZGVyID0gdHJ1ZTtcbiAgICAvKipAaGlkZGVuIEBpbnRlcm5hbCovXG4gICAgcHVibGljIGNvbGxhcHNlZCA9IHRydWU7XG4gICAgLyoqQGhpZGRlbiBAaW50ZXJuYWwqL1xuICAgIHB1YmxpYyBkaXNwbGF5VmFsdWVQaXBlID0gbmV3IERhdGVQaWNrZXJEaXNwbGF5VmFsdWVQaXBlKHRoaXMpO1xuICAgIC8qKkBoaWRkZW4gQGludGVybmFsKi9cbiAgICBwdWJsaWMgaW5wdXRWYWx1ZVBpcGUgPSBuZXcgRGF0ZVBpY2tlcklucHV0VmFsdWVQaXBlKHRoaXMpO1xuICAgIC8qKkBoaWRkZW4gQGludGVybmFsKi9cbiAgICBwdWJsaWMgZGF0ZUZvcm1hdFBhcnRzID0gW107XG4gICAgLyoqQGhpZGRlbiBAaW50ZXJuYWwqL1xuICAgIHB1YmxpYyByYXdEYXRlU3RyaW5nOiBzdHJpbmc7XG4gICAgLyoqQGhpZGRlbiBAaW50ZXJuYWwqL1xuICAgIHB1YmxpYyBpbnB1dE1hc2s6IHN0cmluZztcbiAgICAvKipAaGlkZGVuIEBpbnRlcm5hbCovXG4gICAgcHVibGljIGlzRW1wdHkgPSB0cnVlO1xuICAgIC8qKkBoaWRkZW4gQGludGVybmFsKi9cbiAgICBwdWJsaWMgaW52YWxpZERhdGUgPSAnJztcblxuICAgIHByaXZhdGUgcmVhZG9ubHkgc3BpbkRlbHRhID0gMTtcbiAgICBwcml2YXRlIHJlYWRvbmx5IGRlZmF1bHRMb2NhbGUgPSAnZW4nO1xuXG4gICAgcHJpdmF0ZSBfZm9ybWF0T3B0aW9ucyA9IHtcbiAgICAgICAgZGF5OiAnbnVtZXJpYycsXG4gICAgICAgIG1vbnRoOiAnc2hvcnQnLFxuICAgICAgICB3ZWVrZGF5OiAnc2hvcnQnLFxuICAgICAgICB5ZWFyOiAnbnVtZXJpYydcbiAgICB9O1xuICAgIHByaXZhdGUgX2Zvcm1hdFZpZXdzID0ge1xuICAgICAgICBkYXk6IGZhbHNlLFxuICAgICAgICBtb250aDogdHJ1ZSxcbiAgICAgICAgeWVhcjogZmFsc2VcbiAgICB9O1xuICAgIHByaXZhdGUgX2Rlc3Ryb3kkID0gbmV3IFN1YmplY3Q8Ym9vbGVhbj4oKTtcbiAgICBwcml2YXRlIF9zdGF0dXNDaGFuZ2VzJDogU3Vic2NyaXB0aW9uO1xuICAgIHByaXZhdGUgX2NvbXBvbmVudElEOiBzdHJpbmc7XG4gICAgcHJpdmF0ZSBfZm9ybWF0OiBzdHJpbmc7XG4gICAgcHJpdmF0ZSBfdmFsdWU6IERhdGU7XG4gICAgcHJpdmF0ZSBfaXNJbkVkaXRNb2RlOiBib29sZWFuO1xuICAgIHByaXZhdGUgX2Rpc2FibGVkRGF0ZXM6IERhdGVSYW5nZURlc2NyaXB0b3JbXSA9IG51bGw7XG4gICAgcHJpdmF0ZSBfc3BlY2lhbERhdGVzOiBEYXRlUmFuZ2VEZXNjcmlwdG9yW10gPSBudWxsO1xuICAgIHByaXZhdGUgX21vZGFsT3ZlcmxheTogT3ZlcmxheVNldHRpbmdzO1xuICAgIHByaXZhdGUgX2Ryb3BEb3duT3ZlcmxheVNldHRpbmdzOiBPdmVybGF5U2V0dGluZ3M7XG4gICAgcHJpdmF0ZSBfcG9zaXRpb25TZXR0aW5nczogUG9zaXRpb25TZXR0aW5ncztcbiAgICBwcml2YXRlIF9kZWZhdWx0RHJvcERvd25PdmVybGF5U2V0dGluZ3M6IE92ZXJsYXlTZXR0aW5ncztcbiAgICBwcml2YXRlIF9tb2RhbE92ZXJsYXlTZXR0aW5nczogT3ZlcmxheVNldHRpbmdzO1xuICAgIHByaXZhdGUgX3RyYW5zZm9ybWVkRGF0ZTtcbiAgICBwcml2YXRlIF9vbk9wZW4gPSBuZXcgRXZlbnRFbWl0dGVyPElneERhdGVQaWNrZXJDb21wb25lbnQ+KCk7XG4gICAgcHJpdmF0ZSBfb25DbG9zZSA9IG5ldyBFdmVudEVtaXR0ZXI8SWd4RGF0ZVBpY2tlckNvbXBvbmVudD4oKTtcbiAgICBwcml2YXRlIF9uZ0NvbnRyb2w6IE5nQ29udHJvbCA9IG51bGw7XG5cbiAgICAvLyNyZWdpb24gQ29udHJvbFZhbHVlQWNjZXNzb3JcblxuICAgIHByaXZhdGUgX29uQ2hhbmdlQ2FsbGJhY2s6IChfOiBEYXRlKSA9PiB2b2lkID0gbm9vcDtcblxuICAgIHByaXZhdGUgX29uVG91Y2hlZENhbGxiYWNrOiAoKSA9PiB2b2lkID0gbm9vcDtcblxuICAgIC8qKiBAaGlkZGVuIEBpbnRlcm5hbCAqL1xuICAgIHB1YmxpYyB3cml0ZVZhbHVlKHZhbHVlOiBEYXRlKSB7XG4gICAgICAgIHRoaXMuX3ZhbHVlID0gdmFsdWU7XG4gICAgICAgIC8vIFRPRE86IGRvIHdlIG5lZWQgbmV4dCBjYWxsXG4gICAgICAgIHRoaXMuX2Nkci5tYXJrRm9yQ2hlY2soKTtcbiAgICB9XG5cbiAgICAvKiogQGhpZGRlbiBAaW50ZXJuYWwgKi9cbiAgICBwdWJsaWMgcmVnaXN0ZXJPbkNoYW5nZShmbjogKF86IERhdGUpID0+IHZvaWQpIHsgdGhpcy5fb25DaGFuZ2VDYWxsYmFjayA9IGZuOyB9XG5cbiAgICAvKiogQGhpZGRlbiBAaW50ZXJuYWwgKi9cbiAgICBwdWJsaWMgcmVnaXN0ZXJPblRvdWNoZWQoZm46ICgpID0+IHZvaWQpIHsgdGhpcy5fb25Ub3VjaGVkQ2FsbGJhY2sgPSBmbjsgfVxuXG4gICAgLyoqIEBoaWRkZW4gQGludGVybmFsICovXG4gICAgcHVibGljIHNldERpc2FibGVkU3RhdGUoaXNEaXNhYmxlZDogYm9vbGVhbik6IHZvaWQgeyB0aGlzLmRpc2FibGVkID0gaXNEaXNhYmxlZDsgfVxuXG4gICAgLy8jZW5kcmVnaW9uXG5cbiAgICAvKipcbiAgICAqIEBoaWRkZW5cbiAgICAqL1xuICAgIEBIb3N0TGlzdGVuZXIoJ2tleWRvd24uc3BhY2ViYXInLCBbJyRldmVudCddKVxuICAgIEBIb3N0TGlzdGVuZXIoJ2tleWRvd24uc3BhY2UnLCBbJyRldmVudCddKVxuICAgIHB1YmxpYyBvblNwYWNlQ2xpY2soZXZlbnQ6IEtleWJvYXJkRXZlbnQpIHtcbiAgICAgICAgdGhpcy5vcGVuRGlhbG9nKHRoaXMuZ2V0SW5wdXRHcm91cEVsZW1lbnQoKSk7XG4gICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgfVxuXG5cbiAgICAvKiogQGhpZGRlbiAqL1xuICAgIHB1YmxpYyBnZXRFZGl0RWxlbWVudCgpIHtcbiAgICAgICAgY29uc3QgaW5wdXREaXJlY3RpdmVFbGVtZW50UmVmID0gdGhpcy5faW5wdXRFbGVtZW50UmVmIHx8IHRoaXMuX2lucHV0VXNlclRlbXBsYXRlRWxlbWVudFJlZjtcbiAgICAgICAgcmV0dXJuIChpbnB1dERpcmVjdGl2ZUVsZW1lbnRSZWYpID8gaW5wdXREaXJlY3RpdmVFbGVtZW50UmVmLm5hdGl2ZUVsZW1lbnQgOiBudWxsO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqQGhpZGRlbiBAaW50ZXJuYWxcbiAgICAgKi9cbiAgICBwdWJsaWMgZ2V0SW5wdXRHcm91cEVsZW1lbnQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmlucHV0R3JvdXAgPyB0aGlzLmlucHV0R3JvdXAuZWxlbWVudC5uYXRpdmVFbGVtZW50IDogbnVsbDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKkBoaWRkZW4gQGludGVybmFsXG4gICAgICovXG4gICAgcHVibGljIG5nT25Jbml0KCk6IHZvaWQge1xuICAgICAgICB0aGlzLl9wb3NpdGlvblNldHRpbmdzID0ge1xuICAgICAgICAgICAgb3BlbkFuaW1hdGlvbjogZmFkZUluLFxuICAgICAgICAgICAgY2xvc2VBbmltYXRpb246IGZhZGVPdXRcbiAgICAgICAgfTtcblxuICAgICAgICB0aGlzLl9kZWZhdWx0RHJvcERvd25PdmVybGF5U2V0dGluZ3MgPSB7XG4gICAgICAgICAgICBjbG9zZU9uT3V0c2lkZUNsaWNrOiB0cnVlLFxuICAgICAgICAgICAgbW9kYWw6IGZhbHNlLFxuICAgICAgICAgICAgc2Nyb2xsU3RyYXRlZ3k6IG5ldyBBYnNvbHV0ZVNjcm9sbFN0cmF0ZWd5KCksXG4gICAgICAgICAgICBwb3NpdGlvblN0cmF0ZWd5OiBuZXcgQXV0b1Bvc2l0aW9uU3RyYXRlZ3kodGhpcy5fcG9zaXRpb25TZXR0aW5ncyksXG4gICAgICAgICAgICBvdXRsZXQ6IHRoaXMub3V0bGV0XG4gICAgICAgIH07XG5cbiAgICAgICAgdGhpcy5fbW9kYWxPdmVybGF5U2V0dGluZ3MgPSB7XG4gICAgICAgICAgICBjbG9zZU9uT3V0c2lkZUNsaWNrOiB0cnVlLFxuICAgICAgICAgICAgbW9kYWw6IHRydWUsXG4gICAgICAgICAgICBvdXRsZXQ6IHRoaXMub3V0bGV0XG4gICAgICAgIH07XG5cbiAgICAgICAgdGhpcy5fb3ZlcmxheVNlcnZpY2Uub25PcGVuaW5nLnBpcGUoXG4gICAgICAgICAgICBmaWx0ZXIoKG92ZXJsYXkpID0+IG92ZXJsYXkuaWQgPT09IHRoaXMuX2NvbXBvbmVudElEKSxcbiAgICAgICAgICAgIHRha2VVbnRpbCh0aGlzLl9kZXN0cm95JCkpLnN1YnNjcmliZSgoZXZlbnRBcmdzKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5fb25PcGVuaW5nKGV2ZW50QXJncyk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICB0aGlzLl9vdmVybGF5U2VydmljZS5vbk9wZW5lZC5waXBlKFxuICAgICAgICAgICAgZmlsdGVyKChvdmVybGF5KSA9PiBvdmVybGF5LmlkID09PSB0aGlzLl9jb21wb25lbnRJRCksXG4gICAgICAgICAgICB0YWtlVW50aWwodGhpcy5fZGVzdHJveSQpKS5zdWJzY3JpYmUoKCkgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMuX29uT3BlbmVkKCk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICB0aGlzLl9vdmVybGF5U2VydmljZS5vbkNsb3NlZC5waXBlKFxuICAgICAgICAgICAgZmlsdGVyKG92ZXJsYXkgPT4gb3ZlcmxheS5pZCA9PT0gdGhpcy5fY29tcG9uZW50SUQpLFxuICAgICAgICAgICAgdGFrZVVudGlsKHRoaXMuX2Rlc3Ryb3kkKSkuc3Vic2NyaWJlKCgpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLl9vbkNsb3NlZCgpO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgdGhpcy5fb3ZlcmxheVNlcnZpY2Uub25DbG9zaW5nLnBpcGUoXG4gICAgICAgICAgICBmaWx0ZXIob3ZlcmxheSA9PiBvdmVybGF5LmlkID09PSB0aGlzLl9jb21wb25lbnRJRCksXG4gICAgICAgICAgICB0YWtlVW50aWwodGhpcy5fZGVzdHJveSQpKS5zdWJzY3JpYmUoKGV2ZW50KSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5vbkNsb3NpbmcuZW1pdChldmVudCk7XG4gICAgICAgICAgICAgICAgLy8gSWYgY2FuY2VsZWQgaW4gYSB1c2VyIG9uQ2xvc2luZyBoYW5kbGVyXG4gICAgICAgICAgICAgICAgaWYgKGV2ZW50LmNhbmNlbCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIC8vIERvIG5vdCBmb2N1cyB0aGUgaW5wdXQgaWYgY2xpY2tpbmcgb3V0c2lkZSBpbiBkcm9wZG93biBtb2RlXG4gICAgICAgICAgICAgICAgY29uc3QgaW5wdXQgPSB0aGlzLmdldEVkaXRFbGVtZW50KCk7XG4gICAgICAgICAgICAgICAgaWYgKGlucHV0ICYmICEoZXZlbnQuZXZlbnQgJiYgdGhpcy5tb2RlID09PSBJbnRlcmFjdGlvbk1vZGUuRHJvcERvd24pKSB7XG4gICAgICAgICAgICAgICAgICAgIGlucHV0LmZvY3VzKCk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gb3V0c2lkZSBjbGlja1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl91cGRhdGVWYWxpZGl0eU9uQmx1cigpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgIGlmICh0aGlzLm1vZGUgPT09IEludGVyYWN0aW9uTW9kZS5Ecm9wRG93bikge1xuICAgICAgICAgICAgdGhpcy5kYXRlRm9ybWF0UGFydHMgPSBEYXRlUGlja2VyVXRpbC5wYXJzZURhdGVGb3JtYXQodGhpcy5tYXNrLCB0aGlzLmxvY2FsZSk7XG4gICAgICAgICAgICBpZiAodGhpcy5tYXNrID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICB0aGlzLm1hc2sgPSBEYXRlUGlja2VyVXRpbC5nZXRNYXNrKHRoaXMuZGF0ZUZvcm1hdFBhcnRzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuaW5wdXRNYXNrID0gRGF0ZVBpY2tlclV0aWwuZ2V0SW5wdXRNYXNrKHRoaXMuZGF0ZUZvcm1hdFBhcnRzKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuX25nQ29udHJvbCA9IHRoaXMuX2luamVjdG9yLmdldDxOZ0NvbnRyb2w+KE5nQ29udHJvbCwgbnVsbCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICpAaGlkZGVuIEBpbnRlcm5hbFxuICAgICovXG4gICAgcHVibGljIG5nQWZ0ZXJWaWV3SW5pdCgpIHtcbiAgICAgICAgaWYgKHRoaXMubW9kZSA9PT0gSW50ZXJhY3Rpb25Nb2RlLkRyb3BEb3duICYmIHRoaXMuX2lucHV0RWxlbWVudFJlZikge1xuICAgICAgICAgICAgZnJvbUV2ZW50KHRoaXMuX2lucHV0RWxlbWVudFJlZi5uYXRpdmVFbGVtZW50LCAna2V5ZG93bicpLnBpcGUoXG4gICAgICAgICAgICAgICAgdGhyb3R0bGUoKCkgPT4gaW50ZXJ2YWwoMCwgYW5pbWF0aW9uRnJhbWVTY2hlZHVsZXIpKSxcbiAgICAgICAgICAgICAgICB0YWtlVW50aWwodGhpcy5fZGVzdHJveSQpXG4gICAgICAgICAgICApLnN1YnNjcmliZSgocmVzKSA9PiB0aGlzLm9uS2V5RG93bihyZXMpKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICh0aGlzLl9uZ0NvbnRyb2wpIHtcbiAgICAgICAgICAgIHRoaXMuX3N0YXR1c0NoYW5nZXMkID0gdGhpcy5fbmdDb250cm9sLnN0YXR1c0NoYW5nZXMuc3Vic2NyaWJlKHRoaXMub25TdGF0dXNDaGFuZ2VkLmJpbmQodGhpcykpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHVibGljIG5nQWZ0ZXJWaWV3Q2hlY2tlZCgpIHtcbiAgICAgICAgLy8gaWYgb25lIHNldHMgbW9kZSBhdCBydW4gdGltZSB0aGlzIGZvcmNlcyBpbml0aWFsaXphdGlvbiBvZiBuZXcgaWd4SW5wdXRHcm91cFxuICAgICAgICAvLyBBcyBhIHJlc3VsdCBhIG5ldyBpZ3hJbnB1dERpcmVjdGl2ZSBpcyBpbml0aWFsaXplZCB0b28uIEluIG5nQWZ0ZXJWaWV3SW5pdCBvZlxuICAgICAgICAvLyB0aGUgbmV3IGRpcmVjdGl2ZSBpc1JlcXVpcmVkIG9mIHRoZSBpZ3hJbnB1dEdyb3VwIGlzIHNldCBhZ2Fpbi4gSG93ZXZlclxuICAgICAgICAvLyBuZ0FmdGVyVmlld0luaXQgb2YgZGF0ZSBwaWNrZXIgaXMgbm90IGNhbGxlZCBhZ2FpbiBhbmQgd2UgbWF5IGZpbmlzaCB3aXRoIHdyb25nXG4gICAgICAgIC8vIGlzUmVxdWlyZWQgaW4gaWd4SW5wdXRHcm91cC4gVGhpcyBpcyB3aHkgd2Ugc2hvdWxkIHNldCBpdCBoZXIsIG9ubHkgd2hlbiBuZWVkZWRcbiAgICAgICAgaWYgKHRoaXMuaW5wdXRHcm91cCAmJiB0aGlzLmlucHV0R3JvdXAuaXNSZXF1aXJlZCAhPT0gdGhpcy5yZXF1aXJlZCkge1xuICAgICAgICAgICAgdGhpcy5pbnB1dEdyb3VwLmlzUmVxdWlyZWQgPSB0aGlzLnJlcXVpcmVkO1xuICAgICAgICAgICAgdGhpcy5fY2RyLmRldGVjdENoYW5nZXMoKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHByb3RlY3RlZCBvblN0YXR1c0NoYW5nZWQoKSB7XG4gICAgICAgIGlmICgodGhpcy5fbmdDb250cm9sLmNvbnRyb2wudG91Y2hlZCB8fCB0aGlzLl9uZ0NvbnRyb2wuY29udHJvbC5kaXJ0eSkgJiZcbiAgICAgICAgICAgICh0aGlzLl9uZ0NvbnRyb2wuY29udHJvbC52YWxpZGF0b3IgfHwgdGhpcy5fbmdDb250cm9sLmNvbnRyb2wuYXN5bmNWYWxpZGF0b3IpKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5pbnB1dEdyb3VwLmlzRm9jdXNlZCkge1xuICAgICAgICAgICAgICAgIHRoaXMuX2lucHV0RGlyZWN0aXZlLnZhbGlkID0gdGhpcy5fbmdDb250cm9sLnZhbGlkID8gSWd4SW5wdXRTdGF0ZS5WQUxJRCA6IElneElucHV0U3RhdGUuSU5WQUxJRDtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5faW5wdXREaXJlY3RpdmUudmFsaWQgPSB0aGlzLl9uZ0NvbnRyb2wudmFsaWQgPyBJZ3hJbnB1dFN0YXRlLklOSVRJQUwgOiBJZ3hJbnB1dFN0YXRlLklOVkFMSUQ7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBpZiAodGhpcy5pbnB1dEdyb3VwICYmIHRoaXMuaW5wdXRHcm91cC5pc1JlcXVpcmVkICE9PSB0aGlzLnJlcXVpcmVkKSB7XG4gICAgICAgICAgICB0aGlzLmlucHV0R3JvdXAuaXNSZXF1aXJlZCA9IHRoaXMucmVxdWlyZWQ7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKkBoaWRkZW4gQGludGVybmFsXG4gICAgKi9cbiAgICBwdWJsaWMgbmdPbkRlc3Ryb3koKTogdm9pZCB7XG4gICAgICAgIGlmICh0aGlzLl9jb21wb25lbnRJRCkge1xuICAgICAgICAgICAgdGhpcy5fb3ZlcmxheVNlcnZpY2UuaGlkZSh0aGlzLl9jb21wb25lbnRJRCk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5fZGVzdHJveSQubmV4dCh0cnVlKTtcbiAgICAgICAgdGhpcy5fZGVzdHJveSQuY29tcGxldGUoKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKlNlbGVjdHMgdG9kYXkncyBkYXRlIGZyb20gY2FsZW5kYXIuXG4gICAgICpAcmVtYXJrc1xuICAgICAqQ2hhbmdlcyB0aGUgaW5wdXQgZmllbGQgdmFsdWUsIEBjYWxlbmRhci52aWV3RGF0ZSBhbmQgQGNhbGVuZGFyLnZhbHVlLlxuICAgICAqQGV4YW1wbGVcbiAgICAgKmBgYHR5cGVzY3JpcHRcbiAgICAgKnRoaXMuZGF0ZVBpY2tlci50cmlnZ2VyVG9kYXlTZWxlY3Rpb24oKTtcbiAgICAgKmBgYFxuICAgICAqL1xuICAgIHB1YmxpYyB0cmlnZ2VyVG9kYXlTZWxlY3Rpb24oKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IHRvZGF5ID0gbmV3IERhdGUoRGF0ZS5ub3coKSk7XG4gICAgICAgIHRoaXMuaGFuZGxlU2VsZWN0aW9uKHRvZGF5KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDaGFuZ2UgdGhlIGNhbGVuZGFyIHNlbGVjdGlvbi5cbiAgICAgKiBAcmVtYXJrc1xuICAgICAqIENhbGxpbmcgdGhpcyBtZXRob2Qgd2lsbCBlbWl0IHRoZSBAY2FsZW5kYXIub25TZWxlY3Rpb24gZXZlbnQsXG4gICAgICogd2hpY2ggd2lsbCBmaXJlIEBoYW5kbGVTZWxlY3Rpb24gbWV0aG9kLlxuICAgICAqIEBleGFtcGxlXG4gICAgICpgYGB0eXBlc2NyaXB0XG4gICAgICp0aGlzLmRhdGVQaWNrZXIuc2VsZWN0RGF0ZSh0aGlzLmRhdGUpO1xuICAgICAqIGBgYFxuICAgICAqIEBwYXJhbSBkYXRlIHBhc3NlZCBkYXRlIHRoYXQgaGFzIHRvIGJlIHNldCB0byB0aGUgY2FsZW5kYXIuXG4gICAgICovXG4gICAgcHVibGljIHNlbGVjdERhdGUoZGF0ZTogRGF0ZSk6IHZvaWQge1xuICAgICAgICBjb25zdCBvbGRWYWx1ZSA9ICB0aGlzLnZhbHVlO1xuICAgICAgICB0aGlzLnZhbHVlID0gZGF0ZTtcblxuICAgICAgICB0aGlzLmVtaXRWYWx1ZUNoYW5nZUV2ZW50KG9sZFZhbHVlLCB0aGlzLnZhbHVlICk7XG4gICAgICAgIHRoaXMub25TZWxlY3Rpb24uZW1pdChkYXRlKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBEZXNlbGVjdHMgdGhlIGNhbGVuZGFyIGRhdGUuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKmBgYHR5cGVzY3JpcHRcbiAgICAgKnRoaXMuZGF0ZVBpY2tlci5kZXNlbGVjdERhdGUoKTtcbiAgICAgKiBgYGBcbiAgICAgKi9cbiAgICBwdWJsaWMgZGVzZWxlY3REYXRlKCk6IHZvaWQge1xuICAgICAgICBjb25zdCBvbGRWYWx1ZSA9ICB0aGlzLnZhbHVlO1xuICAgICAgICB0aGlzLnZhbHVlID0gbnVsbDtcbiAgICAgICAgdGhpcy5lbWl0VmFsdWVDaGFuZ2VFdmVudChvbGRWYWx1ZSwgdGhpcy52YWx1ZSApO1xuICAgICAgICBpZiAodGhpcy5jYWxlbmRhcikge1xuICAgICAgICAgICAgdGhpcy5jYWxlbmRhci5kZXNlbGVjdERhdGUoKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIE9wZW5zIHRoZSBkYXRlIHBpY2tlciBkcm9wIGRvd24gb3IgZGlhbG9nLlxuICAgICAqIEBwYXJhbSB0YXJnZXQgSFRNTEVsZW1lbnQgLSB0aGUgdGFyZ2V0IGVsZW1lbnQgdG8gdXNlIGZvciBwb3NpdGlvbmluZyB0aGUgZHJvcCBkb3duIGNvbnRhaW5lciBhY2NvcmRpbmcgdG9cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqIGBgYHR5cGVzY3JpcHRcbiAgICAgKiB0aGlzLmRhdGVQaWNrZXIub3BlbkRpYWxvZyh0YXJnZXQpO1xuICAgICAqIGBgYFxuICAgICAqL1xuICAgIHB1YmxpYyBvcGVuRGlhbG9nKHRhcmdldD86IEhUTUxFbGVtZW50KTogdm9pZCB7XG4gICAgICAgIGlmICghdGhpcy5jb2xsYXBzZWQpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBzd2l0Y2ggKHRoaXMubW9kZSkge1xuICAgICAgICAgICAgY2FzZSBJbnRlcmFjdGlvbk1vZGUuRGlhbG9nOiB7XG4gICAgICAgICAgICAgICAgdGhpcy5oYXNIZWFkZXIgPSB0cnVlO1xuICAgICAgICAgICAgICAgIGNvbnN0IG1vZGFsT3ZlcmxheSA9ICh0aGlzLm1vZGFsT3ZlcmxheVNldHRpbmdzICE9PSB1bmRlZmluZWQpID8gdGhpcy5fbW9kYWxPdmVybGF5IDogdGhpcy5fbW9kYWxPdmVybGF5U2V0dGluZ3M7XG4gICAgICAgICAgICAgICAgdGhpcy5fY29tcG9uZW50SUQgPSB0aGlzLl9vdmVybGF5U2VydmljZS5hdHRhY2goSWd4Q2FsZW5kYXJDb250YWluZXJDb21wb25lbnQsIG1vZGFsT3ZlcmxheSwgdGhpcy5fbW9kdWxlUmVmKTtcbiAgICAgICAgICAgICAgICB0aGlzLl9vdmVybGF5U2VydmljZS5zaG93KHRoaXMuX2NvbXBvbmVudElEKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhc2UgSW50ZXJhY3Rpb25Nb2RlLkRyb3BEb3duOiB7XG4gICAgICAgICAgICAgICAgdGhpcy5oYXNIZWFkZXIgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICBpZiAodGFyZ2V0KSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZHJvcERvd25PdmVybGF5U2V0dGluZ3MucG9zaXRpb25TdHJhdGVneS5zZXR0aW5ncy50YXJnZXQgPSB0YXJnZXQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXMuX2NvbXBvbmVudElEID0gdGhpcy5fb3ZlcmxheVNlcnZpY2UuYXR0YWNoKElneENhbGVuZGFyQ29udGFpbmVyQ29tcG9uZW50LFxuICAgICAgICAgICAgICAgICAgICB0aGlzLmRyb3BEb3duT3ZlcmxheVNldHRpbmdzLCB0aGlzLl9tb2R1bGVSZWYpO1xuICAgICAgICAgICAgICAgIHRoaXMuX292ZXJsYXlTZXJ2aWNlLnNob3codGhpcy5fY29tcG9uZW50SUQpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHVibGljIG1vdXNlRG93bihlKSB7XG4gICAgICAgIC8vIGlmIHRoZSBjbGljayBpcyBub3Qgb24gdGhlIGlucHV0IGJ1dCBpbiBpbnB1dCBncm91cFxuICAgICAgICAvLyBlLmcuIG9uIHByZWZpeCBvciBzdWZpeCwgcHJldmVudCBkZWZhdWx0IGFuZCB0aGlzIHdheSBwcmV2ZW50IGJsdXJcbiAgICAgICAgaWYgKGUudGFyZ2V0ICE9PSB0aGlzLmdldEVkaXRFbGVtZW50KCkpIHtcbiAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENsb3NlIHRoZSBjYWxlbmRhci5cbiAgICAgKlxuICAgICAqIEBoaWRkZW4gQGludGVybmFsXG4gICAgICovXG4gICAgcHVibGljIGNsb3NlQ2FsZW5kYXIoKTogdm9pZCB7XG4gICAgICAgIHRoaXMuX292ZXJsYXlTZXJ2aWNlLmhpZGUodGhpcy5fY29tcG9uZW50SUQpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENsZWFyIHRoZSBpbnB1dCBmaWVsZCwgZGF0ZSBwaWNrZXIgdmFsdWUgYW5kIGNhbGVuZGFyIHNlbGVjdGlvbi5cbiAgICAgKlxuICAgICAqIEBoaWRkZW4gQGludGVybmFsXG4gICAgICovXG4gICAgcHVibGljIGNsZWFyKCk6IHZvaWQge1xuICAgICAgICB0aGlzLmlzRW1wdHkgPSB0cnVlO1xuICAgICAgICB0aGlzLmludmFsaWREYXRlID0gJyc7XG4gICAgICAgIHRoaXMuZGVzZWxlY3REYXRlKCk7XG4gICAgICAgIHRoaXMuX3NldEN1cnNvclBvc2l0aW9uKDApO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEV2YWx1YXRlcyB3aGVuIEBjYWxlbmRhci5vblNlbGVjdGlvbiBldmVudCB3YXMgZmlyZWRcbiAgICAgKiBhbmQgdXBkYXRlIHRoZSBpbnB1dCB2YWx1ZS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBldmVudCBzZWxlY3RlZCB2YWx1ZSBmcm9tIGNhbGVuZGFyLlxuICAgICAqXG4gICAgICogQGhpZGRlbiBAaW50ZXJuYWxcbiAgICAgKi9cbiAgICBwdWJsaWMgaGFuZGxlU2VsZWN0aW9uKGRhdGU6IERhdGUpOiB2b2lkIHtcbiAgICAgICAgaWYgKHRoaXMudmFsdWUpIHtcbiAgICAgICAgICAgIGRhdGUuc2V0SG91cnModGhpcy52YWx1ZS5nZXRIb3VycygpKTtcbiAgICAgICAgICAgIGRhdGUuc2V0TWludXRlcyh0aGlzLnZhbHVlLmdldE1pbnV0ZXMoKSk7XG4gICAgICAgICAgICBkYXRlLnNldFNlY29uZHModGhpcy52YWx1ZS5nZXRTZWNvbmRzKCkpO1xuICAgICAgICAgICAgZGF0ZS5zZXRNaWxsaXNlY29uZHModGhpcy52YWx1ZS5nZXRNaWxsaXNlY29uZHMoKSk7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3Qgb2xkVmFsdWUgPSAgdGhpcy52YWx1ZTtcbiAgICAgICAgdGhpcy52YWx1ZSA9IGRhdGU7XG5cbiAgICAgICAgdGhpcy5lbWl0VmFsdWVDaGFuZ2VFdmVudChvbGRWYWx1ZSwgdGhpcy52YWx1ZSApO1xuICAgICAgICB0aGlzLmNhbGVuZGFyLnZpZXdEYXRlID0gZGF0ZTtcbiAgICAgICAgdGhpcy5jbG9zZUNhbGVuZGFyKCk7XG4gICAgICAgIHRoaXMub25TZWxlY3Rpb24uZW1pdChkYXRlKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAqIEBoaWRkZW4gQGludGVybmFsXG4gICAgKi9cbiAgICBwdWJsaWMgb25CbHVyKGV2ZW50KTogdm9pZCB7XG4gICAgICAgIHRoaXMuX2lzSW5FZGl0TW9kZSA9IGZhbHNlO1xuICAgICAgICBpZiAodGhpcy5tb2RlID09PSBJbnRlcmFjdGlvbk1vZGUuRHJvcERvd24pIHtcbiAgICAgICAgICAgIHRoaXMuY2FsY3VsYXRlRGF0ZShldmVudC50YXJnZXQudmFsdWUsIGV2ZW50LnR5cGUpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHRoaXMuY29sbGFwc2VkKSB7XG4gICAgICAgICAgICB0aGlzLl91cGRhdGVWYWxpZGl0eU9uQmx1cigpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgKiBAaGlkZGVuIEBpbnRlcm5hbFxuICAgICovXG4gICAgcHVibGljIG9uRm9jdXMoKTogdm9pZCB7XG4gICAgICAgIHRoaXMuX2lzSW5FZGl0TW9kZSA9IHRydWU7XG4gICAgICAgIGlmICh0aGlzLnZhbHVlICYmIHRoaXMuaW52YWxpZERhdGUgPT09ICcnKSB7XG4gICAgICAgICAgICB0aGlzLl90cmFuc2Zvcm1lZERhdGUgPSB0aGlzLl9nZXRFZGl0b3JEYXRlKHRoaXMudmFsdWUpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgKiBAaGlkZGVuIEBpbnRlcm5hbFxuICAgICovXG4gICAgcHVibGljIG9uS2V5RG93bihldmVudCkge1xuICAgICAgICBzd2l0Y2ggKGV2ZW50LmtleSkge1xuICAgICAgICAgICAgY2FzZSBLRVlTLlVQX0FSUk9XOlxuICAgICAgICAgICAgY2FzZSBLRVlTLlVQX0FSUk9XX0lFOlxuICAgICAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgICAgZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICAgICAgICAgICAgdGhpcy5zcGluVmFsdWUoZXZlbnQudGFyZ2V0LnZhbHVlLCAxLCBldmVudC50eXBlKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgS0VZUy5ET1dOX0FSUk9XOlxuICAgICAgICAgICAgY2FzZSBLRVlTLkRPV05fQVJST1dfSUU6XG4gICAgICAgICAgICAgICAgaWYgKGV2ZW50LmFsdEtleSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLm9wZW5EaWFsb2codGhpcy5nZXRJbnB1dEdyb3VwRWxlbWVudCgpKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgICAgICAgICBldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zcGluVmFsdWUoZXZlbnQudGFyZ2V0LnZhbHVlLCAtMSwgZXZlbnQudHlwZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICogQGhpZGRlbiBAaW50ZXJuYWxcbiAgICAqL1xuICAgIHB1YmxpYyBvbldoZWVsKGV2ZW50KSB7XG4gICAgICAgIGlmICh0aGlzLl9pc0luRWRpdE1vZGUpIHtcbiAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICBldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgICAgICAgIGNvbnN0IHNpZ24gPSAoZXZlbnQuZGVsdGFZID4gMCkgPyAtMSA6IDE7XG4gICAgICAgICAgICB0aGlzLnNwaW5WYWx1ZShldmVudC50YXJnZXQudmFsdWUsIHNpZ24sIGV2ZW50LnR5cGUpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgKiBAaGlkZGVuIEBpbnRlcm5hbFxuICAgICovXG4gICAgcHVibGljIG9uSW5wdXQoZXZlbnQpIHtcbiAgICAgICAgY29uc3QgdGFyZ2V0VmFsdWUgPSBldmVudC50YXJnZXQudmFsdWU7XG4gICAgICAgIGNvbnN0IGN1cnNvclBvc2l0aW9uID0gdGhpcy5fZ2V0Q3Vyc29yUG9zaXRpb24oKTtcbiAgICAgICAgY29uc3QgY2hlY2tJbnB1dCA9IERhdGVQaWNrZXJVdGlsLmNoZWNrRm9yQ29tcGxldGVEYXRlSW5wdXQodGhpcy5kYXRlRm9ybWF0UGFydHMsIHRhcmdldFZhbHVlKTtcbiAgICAgICAgdGhpcy5faXNJbkVkaXRNb2RlID0gdHJ1ZTtcblxuICAgICAgICBpZiAodGFyZ2V0VmFsdWUgIT09IERhdGVQaWNrZXJVdGlsLm1hc2tUb1Byb21wdENoYXJzKHRoaXMuaW5wdXRNYXNrKSkge1xuICAgICAgICAgICAgdGhpcy5pc0VtcHR5ID0gZmFsc2U7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBJZiBhbGwgZGF0ZSBwYXJ0cyBhcmUgY29tcGxldGVkLCBjaGFuZ2UgdGhlIGRhdGUtcGlja2VyIHZhbHVlLCBzdGF5IGluIGVkaXQgbW9kZVxuICAgICAgICBpZiAoY2hlY2tJbnB1dCA9PT0gJ2NvbXBsZXRlJyAmJiBldmVudC5pbnB1dFR5cGUgIT09ICdkZWxldGVDb250ZW50QmFja3dhcmQnKSB7XG4gICAgICAgICAgICB0aGlzLl90cmFuc2Zvcm1lZERhdGUgPSB0YXJnZXRWYWx1ZTtcbiAgICAgICAgICAgIHRoaXMuY2FsY3VsYXRlRGF0ZSh0YXJnZXRWYWx1ZSwgZXZlbnQudHlwZSk7XG4gICAgICAgICAgICB0aGlzLl9zZXRDdXJzb3JQb3NpdGlvbihjdXJzb3JQb3NpdGlvbik7XG4gICAgICAgIH0gZWxzZSBpZiAoY2hlY2tJbnB1dCA9PT0gJ3BhcnRpYWwnKSB7XG4gICAgICAgICAgICAvLyBXaGlsZSBlZGl0aW5nLCBpZiBvbmUgZGF0ZSBwYXJ0IGlzIGRlbGV0ZWQsIGRhdGUtcGlja2VyIHZhbHVlIGlzIHNldCB0byBudWxsLCB0aGUgcmVtYWluaW5nIGlucHV0IHN0YXlzIGludGFjdC5cbiAgICAgICAgICAgIHRoaXMuZGVzZWxlY3REYXRlKCk7XG4gICAgICAgICAgICByZXF1ZXN0QW5pbWF0aW9uRnJhbWUoKCkgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMuZ2V0RWRpdEVsZW1lbnQoKS52YWx1ZSA9IHRhcmdldFZhbHVlO1xuICAgICAgICAgICAgICAgIHRoaXMuX3NldEN1cnNvclBvc2l0aW9uKGN1cnNvclBvc2l0aW9uKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9IGVsc2UgaWYgKGNoZWNrSW5wdXQgPT09ICdlbXB0eScpIHtcbiAgICAgICAgICAgIC8vIFRvdGFsIGNsZWFuLXVwIGFzIGlucHV0IGlzIGRlbGV0ZWQuXG4gICAgICAgICAgICB0aGlzLmlzRW1wdHkgPSB0cnVlO1xuICAgICAgICAgICAgdGhpcy5kZXNlbGVjdERhdGUoKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHByaXZhdGUgZW1pdFZhbHVlQ2hhbmdlRXZlbnQob2xkVmFsdWU6IERhdGUsIG5ld1ZhbHVlOiBEYXRlKSB7XG4gICAgICAgIGlmICghaXNFcXVhbChvbGRWYWx1ZSwgbmV3VmFsdWUpKSB7XG4gICAgICAgICAgICB0aGlzLnZhbHVlQ2hhbmdlLmVtaXQobmV3VmFsdWUpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBjYWxjdWxhdGVEYXRlKGRhdGVTdHJpbmc6IHN0cmluZywgaW52b2tlZEJ5RXZlbnQ6IHN0cmluZyk6IHZvaWQge1xuICAgICAgICBpZiAoZGF0ZVN0cmluZyAhPT0gJycpIHtcbiAgICAgICAgICAgIGNvbnN0IHByZXZEYXRlVmFsdWUgPSB0aGlzLnZhbHVlO1xuICAgICAgICAgICAgY29uc3QgaW5wdXRWYWx1ZSA9IChpbnZva2VkQnlFdmVudCA9PT0gJ2JsdXInKSA/IHRoaXMucmF3RGF0ZVN0cmluZyA6IGRhdGVTdHJpbmc7XG4gICAgICAgICAgICBjb25zdCBuZXdEYXRlQXJyYXkgPSBEYXRlUGlja2VyVXRpbC5wYXJzZURhdGVBcnJheSh0aGlzLmRhdGVGb3JtYXRQYXJ0cywgcHJldkRhdGVWYWx1ZSwgaW5wdXRWYWx1ZSk7XG5cbiAgICAgICAgICAgIGlmIChuZXdEYXRlQXJyYXkuc3RhdGUgPT09IERhdGVTdGF0ZS5WYWxpZCkge1xuICAgICAgICAgICAgICAgIGNvbnN0IG5ld1ZhbHVlID0gbmV3RGF0ZUFycmF5LmRhdGU7XG4gICAgICAgICAgICAgICAgLy8gUmVzdG9yZSB0aGUgdGltZSBwYXJ0IGlmIGFueVxuICAgICAgICAgICAgICAgIGlmIChwcmV2RGF0ZVZhbHVlKSB7XG4gICAgICAgICAgICAgICAgICAgIG5ld1ZhbHVlLnNldEhvdXJzKHByZXZEYXRlVmFsdWUuZ2V0SG91cnMoKSk7XG4gICAgICAgICAgICAgICAgICAgIG5ld1ZhbHVlLnNldE1pbnV0ZXMocHJldkRhdGVWYWx1ZS5nZXRNaW51dGVzKCkpO1xuICAgICAgICAgICAgICAgICAgICBuZXdWYWx1ZS5zZXRTZWNvbmRzKHByZXZEYXRlVmFsdWUuZ2V0U2Vjb25kcygpKTtcbiAgICAgICAgICAgICAgICAgICAgbmV3VmFsdWUuc2V0TWlsbGlzZWNvbmRzKHByZXZEYXRlVmFsdWUuZ2V0TWlsbGlzZWNvbmRzKCkpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmICh0aGlzLmRpc2FibGVkRGF0ZXMgPT09IG51bGxcbiAgICAgICAgICAgICAgICAgICAgfHwgKHRoaXMuZGlzYWJsZWREYXRlcyAhPT0gbnVsbCAmJiAhaXNEYXRlSW5SYW5nZXMobmV3VmFsdWUsIHRoaXMuZGlzYWJsZWREYXRlcykpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBvbGRWYWx1ZSA9ICB0aGlzLnZhbHVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy52YWx1ZSA9IG5ld1ZhbHVlO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmVtaXRWYWx1ZUNoYW5nZUV2ZW50KG9sZFZhbHVlLCB0aGlzLnZhbHVlICk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmludmFsaWREYXRlID0gJyc7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgYXJnczogSURhdGVQaWNrZXJEaXNhYmxlZERhdGVFdmVudEFyZ3MgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRlUGlja2VyOiB0aGlzLFxuICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudFZhbHVlOiBuZXdWYWx1ZSxcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5vbkRpc2FibGVkRGF0ZS5lbWl0KGFyZ3MpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgY29uc3QgYXJnczogSURhdGVQaWNrZXJWYWxpZGF0aW9uRmFpbGVkRXZlbnRBcmdzID0ge1xuICAgICAgICAgICAgICAgICAgICBkYXRlUGlja2VyOiB0aGlzLFxuICAgICAgICAgICAgICAgICAgICBwcmV2VmFsdWU6IHByZXZEYXRlVmFsdWVcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIHRoaXMuaW52YWxpZERhdGUgPSBkYXRlU3RyaW5nO1xuICAgICAgICAgICAgICAgIHRoaXMub25WYWxpZGF0aW9uRmFpbGVkLmVtaXQoYXJncyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwcml2YXRlIHNwaW5WYWx1ZShpbnB1dFZhbHVlOiBzdHJpbmcsIHNpZ246IG51bWJlciwgZXZlbnRUeXBlOiBzdHJpbmcpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5faXNJbkVkaXRNb2RlID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5pc0VtcHR5ID0gZmFsc2U7XG4gICAgICAgIGNvbnN0IGN1cnNvclBvc2l0aW9uID0gdGhpcy5fZ2V0Q3Vyc29yUG9zaXRpb24oKTtcblxuICAgICAgICBjb25zdCBtb2RpZmllZElucHV0VmFsdWUgPVxuICAgICAgICAgICAgRGF0ZVBpY2tlclV0aWwuZ2V0TW9kaWZpZWREYXRlSW5wdXQodGhpcy5kYXRlRm9ybWF0UGFydHMsIGlucHV0VmFsdWUsIGN1cnNvclBvc2l0aW9uLCB0aGlzLnNwaW5EZWx0YSAqIHNpZ24sIHRoaXMuaXNTcGluTG9vcCk7XG5cbiAgICAgICAgdGhpcy5nZXRFZGl0RWxlbWVudCgpLnZhbHVlID0gbW9kaWZpZWRJbnB1dFZhbHVlO1xuICAgICAgICB0aGlzLl9zZXRDdXJzb3JQb3NpdGlvbihjdXJzb3JQb3NpdGlvbik7XG5cbiAgICAgICAgY29uc3QgY2hlY2tJbnB1dCA9IERhdGVQaWNrZXJVdGlsLmNoZWNrRm9yQ29tcGxldGVEYXRlSW5wdXQodGhpcy5kYXRlRm9ybWF0UGFydHMsIG1vZGlmaWVkSW5wdXRWYWx1ZSk7XG4gICAgICAgIGlmIChjaGVja0lucHV0ID09PSAnY29tcGxldGUnKSB7XG4gICAgICAgICAgICB0aGlzLl9pc0luRWRpdE1vZGUgPSB0cnVlO1xuICAgICAgICAgICAgdGhpcy5jYWxjdWxhdGVEYXRlKG1vZGlmaWVkSW5wdXRWYWx1ZSwgZXZlbnRUeXBlKTtcbiAgICAgICAgICAgIHRoaXMuX3NldEN1cnNvclBvc2l0aW9uKGN1cnNvclBvc2l0aW9uKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHByaXZhdGUgX29uT3BlbmluZyhldmVudDogT3ZlcmxheUNhbmNlbGFibGVFdmVudEFyZ3MpIHtcbiAgICAgICAgdGhpcy5faW5pdGlhbGl6ZUNhbGVuZGFyQ29udGFpbmVyKGV2ZW50LmNvbXBvbmVudFJlZi5pbnN0YW5jZSBhcyBJZ3hDYWxlbmRhckNvbnRhaW5lckNvbXBvbmVudCk7XG4gICAgICAgIHRoaXMuY29sbGFwc2VkID0gZmFsc2U7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBfb25PcGVuZWQoKTogdm9pZCB7XG4gICAgICAgIHRoaXMub25PcGVuZWQuZW1pdCh0aGlzKTtcblxuICAgICAgICAvLyBUT0RPOiByZW1vdmUgdGhpcyBsaW5lIGFmdGVyIGRlcHJlY2F0aW5nICdvbk9wZW4nXG4gICAgICAgIHRoaXMuX29uT3Blbi5lbWl0KHRoaXMpO1xuXG4gICAgICAgIGlmICh0aGlzLmNhbGVuZGFyKSB7XG4gICAgICAgICAgICB0aGlzLl9mb2N1c0NhbGVuZGFyRGF0ZSgpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBfb25DbG9zZWQoKTogdm9pZCB7XG4gICAgICAgIHRoaXMuY29sbGFwc2VkID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5fY29tcG9uZW50SUQgPSBudWxsO1xuICAgICAgICB0aGlzLm9uQ2xvc2VkLmVtaXQodGhpcyk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBfaW5pdGlhbGl6ZUNhbGVuZGFyQ29udGFpbmVyKGNvbXBvbmVudEluc3RhbmNlOiBJZ3hDYWxlbmRhckNvbnRhaW5lckNvbXBvbmVudCkge1xuICAgICAgICB0aGlzLmNhbGVuZGFyID0gY29tcG9uZW50SW5zdGFuY2UuY2FsZW5kYXI7XG4gICAgICAgIGNvbnN0IGlzVmVydGljYWwgPSAodGhpcy52ZXJ0aWNhbCAmJiB0aGlzLm1vZGUgPT09IEludGVyYWN0aW9uTW9kZS5EaWFsb2cpO1xuICAgICAgICB0aGlzLmNhbGVuZGFyLmhhc0hlYWRlciA9IHRoaXMuaGFzSGVhZGVyO1xuICAgICAgICB0aGlzLmNhbGVuZGFyLmZvcm1hdE9wdGlvbnMgPSB0aGlzLmZvcm1hdE9wdGlvbnM7XG4gICAgICAgIHRoaXMuY2FsZW5kYXIuZm9ybWF0Vmlld3MgPSB0aGlzLmZvcm1hdFZpZXdzO1xuICAgICAgICB0aGlzLmNhbGVuZGFyLmxvY2FsZSA9IHRoaXMubG9jYWxlO1xuICAgICAgICB0aGlzLmNhbGVuZGFyLnZlcnRpY2FsID0gaXNWZXJ0aWNhbDtcbiAgICAgICAgdGhpcy5jYWxlbmRhci53ZWVrU3RhcnQgPSB0aGlzLndlZWtTdGFydDtcbiAgICAgICAgdGhpcy5jYWxlbmRhci5zcGVjaWFsRGF0ZXMgPSB0aGlzLnNwZWNpYWxEYXRlcztcbiAgICAgICAgdGhpcy5jYWxlbmRhci5kaXNhYmxlZERhdGVzID0gdGhpcy5kaXNhYmxlZERhdGVzO1xuICAgICAgICB0aGlzLmNhbGVuZGFyLmhlYWRlclRlbXBsYXRlID0gdGhpcy5oZWFkZXJUZW1wbGF0ZTtcbiAgICAgICAgdGhpcy5jYWxlbmRhci5zdWJoZWFkZXJUZW1wbGF0ZSA9IHRoaXMuc3ViaGVhZGVyVGVtcGxhdGU7XG4gICAgICAgIHRoaXMuY2FsZW5kYXIuaGlkZU91dHNpZGVEYXlzID0gdGhpcy5oaWRlT3V0c2lkZURheXM7XG4gICAgICAgIHRoaXMuY2FsZW5kYXIubW9udGhzVmlld051bWJlciA9IHRoaXMubW9udGhzVmlld051bWJlcjtcbiAgICAgICAgdGhpcy5jYWxlbmRhci5vblNlbGVjdGlvbi5waXBlKHRha2VVbnRpbCh0aGlzLl9kZXN0cm95JCkpLnN1YnNjcmliZSgoZXY6IERhdGUpID0+IHRoaXMuaGFuZGxlU2VsZWN0aW9uKGV2KSk7XG5cbiAgICAgICAgaWYgKHRoaXMudmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXMuY2FsZW5kYXIudmFsdWUgPSB0aGlzLnZhbHVlO1xuICAgICAgICAgICAgdGhpcy5jYWxlbmRhci52aWV3RGF0ZSA9IHRoaXMudmFsdWU7XG4gICAgICAgIH1cblxuICAgICAgICBjb21wb25lbnRJbnN0YW5jZS5tb2RlID0gdGhpcy5tb2RlO1xuICAgICAgICBjb21wb25lbnRJbnN0YW5jZS52ZXJ0aWNhbCA9IGlzVmVydGljYWw7XG4gICAgICAgIGNvbXBvbmVudEluc3RhbmNlLmNhbmNlbEJ1dHRvbkxhYmVsID0gdGhpcy5jYW5jZWxCdXR0b25MYWJlbDtcbiAgICAgICAgY29tcG9uZW50SW5zdGFuY2UudG9kYXlCdXR0b25MYWJlbCA9IHRoaXMudG9kYXlCdXR0b25MYWJlbDtcbiAgICAgICAgY29tcG9uZW50SW5zdGFuY2UuZGF0ZVBpY2tlckFjdGlvbnMgPSB0aGlzLmRhdGVQaWNrZXJBY3Rpb25zRGlyZWN0aXZlO1xuXG4gICAgICAgIGNvbXBvbmVudEluc3RhbmNlLm9uQ2xvc2UucGlwZSh0YWtlVW50aWwodGhpcy5fZGVzdHJveSQpKS5zdWJzY3JpYmUoKCkgPT4gdGhpcy5jbG9zZUNhbGVuZGFyKCkpO1xuICAgICAgICBjb21wb25lbnRJbnN0YW5jZS5vblRvZGF5U2VsZWN0aW9uLnBpcGUodGFrZVVudGlsKHRoaXMuX2Rlc3Ryb3kkKSkuc3Vic2NyaWJlKCgpID0+IHRoaXMudHJpZ2dlclRvZGF5U2VsZWN0aW9uKCkpO1xuICAgIH1cblxuICAgIC8vIEZvY3VzIGEgZGF0ZSwgYWZ0ZXIgdGhlIGNhbGVuZGFyIGFwcGVhcmFuY2UgaW50byBET00uXG4gICAgcHJpdmF0ZSBfZm9jdXNDYWxlbmRhckRhdGUoKTogdm9pZCB7XG4gICAgICAgIHJlcXVlc3RBbmltYXRpb25GcmFtZSgoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLmNhbGVuZGFyLmRheXNWaWV3LmZvY3VzQWN0aXZlRGF0ZSgpO1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBwcml2YXRlIF9zZXRMb2NhbGVUb0RhdGUodmFsdWU6IERhdGUpOiBzdHJpbmcge1xuICAgICAgICBpZiAoaXNJRSgpKSB7XG4gICAgICAgICAgICAvLyB0aGlzIGlzIGEgd29ya2Fyb3VuZCBmaXhpbmcgdGhlIGZvbGxvd2luZyBJRTExIGlzc3VlOlxuICAgICAgICAgICAgLy8gSUUxMSBoYXMgYWRkZWQgY2hhcmFjdGVyIGNvZGUgODIwNiAobWFyayBmb3IgUlRMKSB0byB0aGUgb3V0cHV0IG9mIHRvTG9jYWxlRGF0ZVN0cmluZygpIHRoYXRcbiAgICAgICAgICAgIC8vIHByZWNlZGVzIGVhY2ggcG9ydGlvbiB0aGF0IGNvbXByaXNlcyB0aGUgdG90YWwgZGF0ZS4uLiBGb3IgbW9yZSBpbmZvcm1hdGlvbiByZWFkIHRoaXMgYXJ0aWNsZTpcbiAgICAgICAgICAgIC8vIHRzbGludDpkaXNhYmxlLW5leHQtbGluZTogbWF4LWxpbmUtbGVuZ3RoXG4gICAgICAgICAgICAvLyBodHRwczovL3d3dy5jc2dwcm8uY29tL2Jsb2cvMjAxNi8wOC9hLWJhZC1kYXRlLXdpdGgtaW50ZXJuZXQtZXhwbG9yZXItMTEtdHJvdWJsZS13aXRoLW5ldy11bmljb2RlLWNoYXJhY3RlcnMtaW4tamF2YXNjcmlwdC1kYXRlLXN0cmluZ3MvXG4gICAgICAgICAgICBjb25zdCBsb2NhbGVEYXRlU3RySUUgPSBuZXcgRGF0ZSh2YWx1ZS5nZXRGdWxsWWVhcigpLCB2YWx1ZS5nZXRNb250aCgpLCB2YWx1ZS5nZXREYXRlKCksXG4gICAgICAgICAgICAgICAgdmFsdWUuZ2V0SG91cnMoKSwgdmFsdWUuZ2V0TWludXRlcygpLCB2YWx1ZS5nZXRTZWNvbmRzKCksIHZhbHVlLmdldE1pbGxpc2Vjb25kcygpKTtcbiAgICAgICAgICAgIHJldHVybiBsb2NhbGVEYXRlU3RySUUudG9Mb2NhbGVEYXRlU3RyaW5nKHRoaXMubG9jYWxlKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB2YWx1ZS50b0xvY2FsZURhdGVTdHJpbmcodGhpcy5sb2NhbGUpO1xuICAgIH1cblxuICAgIHByaXZhdGUgX2dldEN1cnNvclBvc2l0aW9uKCk6IG51bWJlciB7XG4gICAgICAgIHJldHVybiB0aGlzLmdldEVkaXRFbGVtZW50KCkuc2VsZWN0aW9uU3RhcnQ7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBfc2V0Q3Vyc29yUG9zaXRpb24oc3RhcnQ6IG51bWJlciwgZW5kOiBudW1iZXIgPSBzdGFydCk6IHZvaWQge1xuICAgICAgICByZXF1ZXN0QW5pbWF0aW9uRnJhbWUoKCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5nZXRFZGl0RWxlbWVudCgpLnNldFNlbGVjdGlvblJhbmdlKHN0YXJ0LCBlbmQpO1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBBcHBseSBjdXN0b20gdXNlciBmb3JtYXR0ZXIgdXBvbiBkYXRlLlxuICAgICAqIEBwYXJhbSBmb3JtYXR0ZXIgY3VzdG9tIGZvcm1hdHRlciBmdW5jdGlvbi5cbiAgICAgKiBAcGFyYW0gZGF0ZSBwYXNzZWQgZGF0ZVxuICAgICAqL1xuICAgIHByaXZhdGUgX2N1c3RvbUZvcm1hdENoZWNrZXIoZm9ybWF0dGVyOiAoXzogRGF0ZSkgPT4gc3RyaW5nLCBkYXRlOiBEYXRlKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmZvcm1hdHRlciA/IHRoaXMuZm9ybWF0dGVyKGRhdGUpIDogdGhpcy5fc2V0TG9jYWxlVG9EYXRlKGRhdGUpO1xuICAgIH1cblxuICAgIC8qXG4gICAgKiBUcmFuc2Zvcm1zIHRoZSBkYXRlIGFjY29yZGluZyB0byB0aGUgc3BlY2lmaWVkIGZvcm1hdCB3aGVuIGBJZ3hEYXRlUGlja2VyQ29tcG9uZW50YCBpcyBpbiBlZGl0IG1vZGVcbiAgICAqIHVzaW5nIEBhbmd1bGFyL2NvbW1vbiBmb3JtYXREYXRlIG1ldGhvZDogaHR0cHM6Ly9hbmd1bGFyLmlvL2FwaS9jb21tb24vZm9ybWF0RGF0ZVxuICAgICogQHBhcmFtICB2YWx1ZTogc3RyaW5nIHwgbnVtYmVyIHwgRGF0ZVxuICAgICogQHJldHVybnMgZm9ybWF0dGVkIHN0cmluZ1xuICAgICovXG4gICAgcHJpdmF0ZSBfZ2V0RGlzcGxheURhdGUodmFsdWU6IGFueSk6IHN0cmluZyB7XG4gICAgICAgIGlmICh0aGlzLmZvcm1hdCAmJiAhdGhpcy5mb3JtYXR0ZXIpIHtcbiAgICAgICAgICAgIGNvbnN0IGxvY2FsZSA9IHRoaXMubG9jYWxlIHx8IHRoaXMuZGVmYXVsdExvY2FsZTtcbiAgICAgICAgICAgIHJldHVybiBmb3JtYXREYXRlKHZhbHVlLCB0aGlzLmZvcm1hdCwgbG9jYWxlKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9jdXN0b21Gb3JtYXRDaGVja2VyKHRoaXMuZm9ybWF0dGVyLCB2YWx1ZSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwcml2YXRlIF9nZXRFZGl0b3JEYXRlKHZhbHVlOiBhbnkpIHtcbiAgICAgICAgY29uc3QgbG9jYWxlID0gdGhpcy5sb2NhbGUgfHwgdGhpcy5kZWZhdWx0TG9jYWxlO1xuICAgICAgICBjb25zdCBjaGFuZ2VkVmFsdWUgPSAodmFsdWUpID8gZm9ybWF0RGF0ZSh2YWx1ZSwgdGhpcy5tYXNrLCBsb2NhbGUpIDogJyc7XG4gICAgICAgIHJldHVybiBEYXRlUGlja2VyVXRpbC5hZGRQcm9tcHRDaGFyc0VkaXRNb2RlKHRoaXMuZGF0ZUZvcm1hdFBhcnRzLCB0aGlzLnZhbHVlLCBjaGFuZ2VkVmFsdWUpO1xuICAgIH1cblxuICAgIHB1YmxpYyBfdXBkYXRlVmFsaWRpdHlPbkJsdXIoKSB7XG4gICAgICAgIHRoaXMuX29uVG91Y2hlZENhbGxiYWNrKCk7XG4gICAgICAgIGNvbnN0IGlucHV0ID0gdGhpcy5faW5wdXREaXJlY3RpdmUgfHwgdGhpcy5faW5wdXREaXJlY3RpdmVVc2VyVGVtcGxhdGU7XG4gICAgICAgIGlmIChpbnB1dCAmJiB0aGlzLl9uZ0NvbnRyb2wgJiYgIXRoaXMuX25nQ29udHJvbC52YWxpZCkge1xuICAgICAgICAgICAgaW5wdXQudmFsaWQgPSBJZ3hJbnB1dFN0YXRlLklOVkFMSUQ7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBpbnB1dC52YWxpZCA9IElneElucHV0U3RhdGUuSU5JVElBTDtcbiAgICAgICAgfVxuICAgIH1cbn1cblxuLyoqXG4gKiBAaGlkZGVuXG4gKi9cbkBOZ01vZHVsZSh7XG4gICAgZGVjbGFyYXRpb25zOiBbXG4gICAgICAgIElneERhdGVQaWNrZXJDb21wb25lbnQsXG4gICAgICAgIElneENhbGVuZGFyQ29udGFpbmVyQ29tcG9uZW50LFxuICAgICAgICBJZ3hEYXRlUGlja2VyQWN0aW9uc0RpcmVjdGl2ZSxcbiAgICAgICAgSWd4RGF0ZVBpY2tlclRlbXBsYXRlRGlyZWN0aXZlLFxuICAgICAgICBEYXRlUGlja2VyRGlzcGxheVZhbHVlUGlwZSxcbiAgICAgICAgRGF0ZVBpY2tlcklucHV0VmFsdWVQaXBlXG4gICAgXSxcbiAgICBlbnRyeUNvbXBvbmVudHM6IFtcbiAgICAgICAgSWd4Q2FsZW5kYXJDb250YWluZXJDb21wb25lbnRcbiAgICBdLFxuICAgIGV4cG9ydHM6IFtcbiAgICAgICAgSWd4RGF0ZVBpY2tlckNvbXBvbmVudCxcbiAgICAgICAgSWd4RGF0ZVBpY2tlclRlbXBsYXRlRGlyZWN0aXZlLFxuICAgICAgICBJZ3hEYXRlUGlja2VyQWN0aW9uc0RpcmVjdGl2ZSxcbiAgICAgICAgRGF0ZVBpY2tlckRpc3BsYXlWYWx1ZVBpcGUsXG4gICAgICAgIERhdGVQaWNrZXJJbnB1dFZhbHVlUGlwZVxuICAgIF0sXG4gICAgaW1wb3J0czogW1xuICAgICAgICBDb21tb25Nb2R1bGUsXG4gICAgICAgIElneEljb25Nb2R1bGUsXG4gICAgICAgIElneElucHV0R3JvdXBNb2R1bGUsXG4gICAgICAgIElneENhbGVuZGFyTW9kdWxlLFxuICAgICAgICBJZ3hCdXR0b25Nb2R1bGUsXG4gICAgICAgIElneFJpcHBsZU1vZHVsZSxcbiAgICAgICAgSWd4TWFza01vZHVsZSxcbiAgICAgICAgSWd4VGV4dFNlbGVjdGlvbk1vZHVsZVxuICAgIF1cbn0pXG5leHBvcnQgY2xhc3MgSWd4RGF0ZVBpY2tlck1vZHVsZSB7IH1cbiJdfQ==